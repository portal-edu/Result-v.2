import{c as D,r as c,j as e,Y as L,G as m,n as P,h as N,A as S,z as R,b as C}from"./index-E6X91Rqg.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=D("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]),$=({classes:g,onRefresh:F})=>{const[o,u]=c.useState(1),[x,v]=c.useState(""),[d,f]=c.useState([]),[h,I]=c.useState([]),[p,b]=c.useState(!1),[y,k]=c.useState({}),A=async()=>{if(!x||d.length===0)return alert("Select Source and Target Classes");b(!0);const s=await C.getStudentAcademicStanding(x);I(s),b(!1),u(2)},w=(s="SHUFFLE")=>{const a={};if(d.forEach(t=>a[t]=[]),s==="DIRECT"){const l=j(x).split(" ").pop()||"";h.forEach(r=>{const n=d.find(i=>j(i).endsWith(l))||d[0];a[n].push({...r,targetClassId:n,isForced:r.status==="FAIL",mode:"DIRECT"})})}else{const t=[...h].sort((n,i)=>i.average-n.average);let l=1,r=0;t.forEach(n=>{const i=d[r];a[i].push({...n,targetClassId:i,isForced:n.status==="FAIL",mode:"SHUFFLE"}),r+=l,r>=d.length&&(r=d.length-1,l=-1),r<0&&(r=0,l=1)})}k(a),u(3)},T=(s,a)=>{k(t=>{const l={...t};return l[s]=l[s].map(r=>r.student.id===a?{...r,isForced:!r.isForced}:r),l})},E=async()=>{if(!window.confirm("Promote these students? This action moves them to the new classes."))return;b(!0);const s=[];Object.values(y).flat().forEach(t=>{(t.status!=="FAIL"||t.isForced)&&s.push({studentId:t.student.id,targetClassId:t.targetClassId,isForced:t.isForced})});const a=await C.promoteStudents(s);b(!1),a.success?(alert("Success! Students Promoted."),u(1),v(""),f([]),F()):alert("Error: "+a.message)},j=s=>{var a;return((a=g.find(t=>t.id===s))==null?void 0:a.name)||s};return e.jsxs("div",{className:"animate-fade-in-up space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 border-b border-slate-100 dark:border-slate-700 pb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:e.jsx(L,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Smart Promotion Wizard"}),e.jsx("p",{className:"text-sm text-slate-500",children:"AI-Assisted Student Promotion & Class Shuffling"})]})]}),e.jsx("div",{className:"flex justify-between items-center max-w-2xl mx-auto mb-8",children:[1,2,3].map(s=>e.jsxs("div",{className:`flex flex-col items-center gap-2 ${o>=s?"opacity-100":"opacity-50"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${o>=s?"bg-purple-600 text-white":"bg-slate-200 text-slate-500"}`,children:s}),e.jsx("span",{className:"text-xs font-bold uppercase",children:s===1?"Select":s===2?"Analyze":"Distribute"})]},s))}),o===1&&e.jsxs(m,{className:"max-w-xl mx-auto space-y-6 p-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-bold text-slate-500 block mb-2",children:"Promote From Class"}),e.jsxs(P,{value:x,onChange:s=>{v(s.target.value)},children:[e.jsx("option",{value:"",children:"Select Class..."}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-bold text-slate-500 block mb-2",children:"Available Target Classes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:g.filter(s=>s.id!==x).map(s=>e.jsxs("label",{className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${d.includes(s.id)?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-slate-200 dark:border-slate-700"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:d.includes(s.id),onChange:a=>{a.target.checked?f(t=>[...t,s.id]):f(t=>t.filter(l=>l!==s.id))}}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:s.name})]},s.id))})]}),e.jsx(N,{onClick:A,disabled:p,className:"w-full flex items-center justify-center gap-2",children:p?"Analyzing...":e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(S,{className:"w-4 h-4"})]})})]}),o===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(m,{className:"bg-gradient-to-r from-purple-500 to-indigo-600 text-white border-none",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold",children:[h.length," Students Found"]}),e.jsx("p",{className:"opacity-90",children:"Ready for distribution. Choose your strategy."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"text-center bg-white/20 p-3 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-2xl font-bold",children:h.filter(s=>s.status==="DISTINCTION").length}),e.jsx("div",{className:"text-xs uppercase opacity-75",children:"Top Performers"})]}),e.jsxs("div",{className:"text-center bg-white/20 p-3 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-2xl font-bold",children:h.filter(s=>s.status==="FAIL").length}),e.jsx("div",{className:"text-xs uppercase opacity-75",children:"Need Support"})]})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(m,{className:"cursor-pointer hover:border-purple-500 transition-all group",onClick:()=>w("DIRECT"),children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center group-hover:bg-blue-600 group-hover:text-white transition-colors",children:e.jsx(S,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Direct Promotion"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Map classes directly (e.g., 10 A â†’ 11 A)"})]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Best for standard yearly promotion without reshuffling."})]}),e.jsxs(m,{className:"cursor-pointer hover:border-pink-500 transition-all group",onClick:()=>w("SHUFFLE"),children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center group-hover:bg-pink-600 group-hover:text-white transition-colors",children:e.jsx(O,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Smart Shuffle"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Distribute based on performance."})]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Best for mixing students to create balanced classes."})]})]})]}),o===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:Object.entries(y).map(([s,a])=>e.jsxs(m,{className:"relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:[e.jsxs("h3",{className:"font-bold text-lg text-purple-700 dark:text-purple-400",children:["Target: ",j(s)]}),e.jsxs("span",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 round-full text-xs font-bold",children:[a.length," Students"]})]}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2",children:a.map((t,l)=>e.jsxs("div",{className:`p-3 rounded-lg flex justify-between items-center border ${t.status==="FAIL"?"bg-red-50 border-red-200 dark:border-red-900/50":t.status==="DISTINCTION"?"bg-green-50 border-green-200 dark:border-green-900/50":"bg-white border-slate-100 dark:bg-slate-800 dark:border-slate-700"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm text-slate-800 dark:text-white",children:t.student.name}),e.jsx("div",{className:"flex gap-2 text-[10px] uppercase font-bold mt-1",children:e.jsxs("span",{className:t.status==="FAIL"?"text-red-600":t.status==="DISTINCTION"?"text-green-600":"text-slate-500",children:[t.status," (",t.average,"%)"]})})]}),t.status==="FAIL"&&e.jsx("button",{onClick:()=>T(s,t.student.id),className:`px-3 py-1.5 rounded text-xs font-bold transition-colors ${t.isForced?"bg-red-600 text-white shadow-md":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:t.isForced?"FORCED":"RETAINED"})]},l))})]},s))}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(N,{onClick:()=>u(1),variant:"outline",children:"Start Over"}),e.jsx(N,{onClick:E,disabled:p,className:"bg-green-600 hover:bg-green-700 text-white border-none px-6",children:p?"Promoting...":e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-4 h-4 mr-2"})," Confirm Promotion"]})})]})]})]})};export{$ as default};
