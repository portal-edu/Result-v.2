import{c as q,r,a as x,j as e,aq as W,an as B,G as v,S as C,b as S,X as z,d as A,l as J}from"./index-CMg5f8vO.js";import{P as V}from"./plus-DrMe97Hf.js";import{T as _}from"./trash-2-CRTkqFI4.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=q("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),se=()=>{const[b,E]=r.useState([]),[n,N]=r.useState(new Date),[h,w]=r.useState(0),[Q,y]=r.useState(!1),[I,m]=r.useState(!1),[a,o]=r.useState({title:"",date:"",type:"ACADEMIC",description:""}),[c,g]=r.useState(null);r.useEffect(()=>{j()},[]);const j=async()=>{y(!0);const[t,s]=await Promise.all([x.getCalendarEvents(),x.getSchoolConfig()]);E(t),s!=null&&s.hijriAdjustment&&w(s.hijriAdjustment),y(!1)},D=async t=>{const s=h+t;w(s),await x.updateSchoolSettings({hijriAdjustment:s})},M=t=>{const s=new Date(t);return s.setDate(s.getDate()+h),new Intl.DateTimeFormat("en-u-ca-islamic-umalqura-nu-latn",{day:"numeric",month:"short"}).format(s)},T=(t,s)=>new Date(t,s+1,0).getDate(),F=(t,s)=>new Date(t,s,1).getDay(),O=()=>{const t=n.getFullYear(),s=n.getMonth(),d=T(t,s),u=F(t,s),P=Array(u).fill(null),G=Array.from({length:d},(l,p)=>p+1),R=[...P,...G];return e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(l=>e.jsx("div",{className:"text-center text-xs font-bold text-slate-500 uppercase py-2",children:l},l)),R.map((l,p)=>{if(!l)return e.jsx("div",{className:"h-24 bg-transparent"},p);const f=`${t}-${String(s+1).padStart(2,"0")}-${String(l).padStart(2,"0")}`,U=b.filter(i=>i.date===f),k=new Date().toISOString().split("T")[0]===f,X=p%7===5;return e.jsxs("div",{onClick:()=>{o({...a,date:f}),m(!0)},className:`h-28 border border-slate-200 dark:border-slate-700 rounded-lg p-2 relative hover:border-blue-400 cursor-pointer transition-colors bg-white dark:bg-slate-800 ${k?"ring-2 ring-blue-500":""} ${X?"bg-slate-50 dark:bg-slate-800/50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:`text-sm font-bold ${k?"text-blue-600":"text-slate-700 dark:text-slate-300"}`,children:l}),e.jsx("span",{className:"text-[9px] text-emerald-600 dark:text-emerald-400 font-mono",children:M(new Date(t,s,l))})]}),e.jsx("div",{className:"mt-2 space-y-1 overflow-y-auto max-h-16 custom-scrollbar",children:U.map(i=>e.jsx("div",{className:`text-[9px] px-1.5 py-0.5 rounded truncate font-medium ${i.type==="HOLIDAY"?"bg-red-100 text-red-700":i.type==="EXAM"?"bg-orange-100 text-orange-700":i.type==="RELIGIOUS"?"bg-emerald-100 text-emerald-700":"bg-blue-100 text-blue-700"}`,children:i.title},i.id))})]},p)})]})},L=async()=>{if(!a.title||!a.date)return alert("Title and Date required");const s=new Date(a.date).getDay();if(a.type==="EXAM"&&s===5&&!confirm("⚠️ Warning: Scheduling an Exam on Friday. This might conflict with Jumu'ah. Continue?"))return;(await x.createCalendarEvent(a)).success?(m(!1),o({title:"",date:"",type:"ACADEMIC",description:""}),j()):alert("Failed")},Y=async t=>{confirm("Delete event?")&&(await x.deleteCalendarEvent(t),j())},$=()=>{const t=new Date;t.setFullYear(t.getFullYear()-1);const s=t.toISOString().split("T")[0],d=b.find(u=>u.date<s);if(d){const u=x.predictNextYearEvent(d);g({title:d.title,oldDate:d.date,newDate:u})}else alert("No historical data found to predict from.")},H=()=>{c&&(o({title:c.title,date:c.newDate,type:"ACADEMIC",description:"Auto-predicted based on last year"}),g(null),m(!0))};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white dark:bg-slate-900 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>N(new Date(n.setMonth(n.getMonth()-1))),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-black text-slate-800 dark:text-white uppercase w-40 text-center",children:n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>N(new Date(n.setMonth(n.getMonth()+1))),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(K,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1.5 rounded-lg border border-emerald-100 dark:border-emerald-800",children:[e.jsx(B,{className:"w-4 h-4 text-emerald-600 mr-2"}),e.jsxs("span",{className:"text-xs font-bold text-emerald-700 dark:text-emerald-400 mr-2",children:["Hijri: ",h>0?`+${h}`:h]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>D(-1),className:"w-5 h-5 bg-white dark:bg-slate-800 rounded text-xs font-bold hover:bg-emerald-100",children:"-"}),e.jsx("button",{onClick:()=>D(1),className:"w-5 h-5 bg-white dark:bg-slate-800 rounded text-xs font-bold hover:bg-emerald-100",children:"+"})]})]}),e.jsxs(v,{onClick:$,variant:"secondary",className:"text-xs flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3 text-purple-500"})," Smart Predict"]}),e.jsxs(v,{onClick:()=>m(!0),className:"flex items-center gap-1 text-xs",children:[e.jsx(V,{className:"w-3 h-3"})," Add Event"]})]})]}),c&&e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 p-4 rounded-xl flex justify-between items-center animate-fade-in-up",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-purple-800 dark:text-purple-300 text-sm flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," Prediction Found"]}),e.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:["Based on pattern, ",e.jsx("b",{children:c.title})," might be on ",e.jsx("b",{children:c.newDate}),"."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(null),className:"px-3 py-1.5 text-xs text-slate-500 font-bold",children:"Dismiss"}),e.jsx("button",{onClick:H,className:"px-3 py-1.5 bg-purple-600 text-white rounded-lg text-xs font-bold shadow-md hover:bg-purple-700",children:"Use Date"})]})]}),e.jsx(S,{className:"p-4",children:O()}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 p-4",children:[e.jsx("h3",{className:"font-bold text-sm text-slate-500 uppercase mb-3",children:"Upcoming Events"}),e.jsxs("div",{className:"space-y-2",children:[b.filter(t=>new Date(t.date)>=new Date).slice(0,5).map(t=>e.jsxs("div",{className:"flex justify-between items-center p-3 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-lg border border-transparent hover:border-slate-200 dark:hover:border-slate-700 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-8 rounded-full ${t.type==="HOLIDAY"?"bg-red-500":t.type==="EXAM"?"bg-orange-500":"bg-blue-500"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-slate-800 dark:text-white",children:t.title}),e.jsxs("p",{className:"text-xs text-slate-500",children:[new Date(t.date).toDateString()," • ",t.type]})]})]}),e.jsx("button",{onClick:()=>Y(t.id),className:"text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(_,{className:"w-4 h-4"})})]},t.id)),b.length===0&&e.jsx("p",{className:"text-center text-xs text-slate-400 py-4",children:"No events scheduled."})]})]}),I&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in-up",children:e.jsxs(S,{className:"w-full max-w-sm relative border-t-4 border-t-blue-500",children:[e.jsx("button",{onClick:()=>m(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx("h3",{className:"font-bold text-lg mb-4 text-slate-800 dark:text-white",children:"Add Event"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Event Title"}),e.jsx(A,{placeholder:"e.g. Annual Day",value:a.title,onChange:t=>o({...a,title:t.target.value}),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Date"}),e.jsx(A,{type:"date",value:a.date,onChange:t=>o({...a,date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Type"}),e.jsxs(J,{value:a.type,onChange:t=>o({...a,type:t.target.value}),children:[e.jsx("option",{value:"ACADEMIC",children:"Academic"}),e.jsx("option",{value:"EXAM",children:"Exam"}),e.jsx("option",{value:"HOLIDAY",children:"Holiday"}),e.jsx("option",{value:"RELIGIOUS",children:"Religious"}),e.jsx("option",{value:"ACTIVITY",children:"Activity"})]})]}),e.jsx(v,{onClick:L,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Save Event"})]})]})})]})};export{se as default};
