import{an as y,u as P,r as t,a as x,j as e,b as h,m as C,G as b,P as L,d as f}from"./index-D6SryyPs.js";const R=()=>{const p=y(),n=P(),a=new URLSearchParams(p.search).get("token"),[E,G]=t.useState(!0),[g,i]=t.useState(!0),[w,j]=t.useState(""),[c,l]=t.useState(""),[r,v]=t.useState(""),[o,N]=t.useState(""),[d,u]=t.useState(!1);t.useEffect(()=>{if(!a){l("Invalid Invite Link"),i(!1);return}k()},[a]);const k=async()=>{const s=await x.verifyPrincipalToken(a);i(!1),s?j(s.name):l("This invite link is invalid or has expired.")},S=async s=>{if(s.preventDefault(),r.length<6)return alert("Password must be at least 6 characters");if(r!==o)return alert("Passwords do not match");u(!0);const m=await x.setupPrincipalPassword(a,r);u(!1),m.success?(alert("Setup Complete! Please login."),n("/login")):l(m.message||"Setup Failed")};return g?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-500",children:"Verifying Invite..."}):c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900 p-4",children:e.jsxs(h,{className:"max-w-md w-full text-center border-t-4 border-red-500",children:[e.jsx(C,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:c}),e.jsx(b,{onClick:()=>n("/"),children:"Back Home"})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900 p-4 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]",children:e.jsxs(h,{className:"max-w-md w-full border-t-4 border-blue-600 shadow-2xl animate-fade-in-up",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600 dark:text-blue-400",children:e.jsx(L,{className:"w-8 h-8"})}),e.jsx("h2",{className:"text-2xl font-black text-slate-900 dark:text-white mb-1",children:"Welcome, Principal"}),e.jsx("p",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:w}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Set your secure access password below."})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Create Password"}),e.jsx(f,{type:"password",placeholder:"Min 6 Characters",value:r,onChange:s=>v(s.target.value),required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Confirm Password"}),e.jsx(f,{type:"password",placeholder:"Re-enter Password",value:o,onChange:s=>N(s.target.value),required:!0,minLength:6})]}),e.jsx("div",{className:"pt-4",children:e.jsx(b,{type:"submit",disabled:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:d?"Setting up...":"Set Password & Login"})})]})]})})};export{R as default};
