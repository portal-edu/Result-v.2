import{c as Ce,r as t,a as N,j as e,G as V,b as z,d as T,A as Be,S as Ee,Z as Ge,C as De,F as Ye,e as He,T as se,f as ze,U as Me,L as Fe,g as fe,h as Re,i as Ve,k as Pe,X as Ie,l as Ue,m as Qe,R as _e,M as We,n as qe,B as Je,o as Xe,p as Ze,u as Ke,H as et,q as tt}from"./index-D6SryyPs.js";import{T as Ae}from"./trash-2-DiBCHKwT.js";import{P as Le}from"./plus-BRsHYFOB.js";import{H as st}from"./hard-drive-xJp8gdrn.js";import{P as at}from"./printer-DzMqpaUt.js";import{P as lt}from"./pen-square-BaUl0ek4.js";import{A as rt}from"./arrow-right-left-o0x_I497.js";import{C as nt,a as ot}from"./clipboard-check-x3lIVnGl.js";import{S as Oe}from"./save-CbEsmIYg.js";import{U as it,a as dt}from"./user-cog-DWzDJayX.js";import{C as ct}from"./clock-DWLV9jIP.js";import{P as xt}from"./pen-xGTzbSjb.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Ce("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ce("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=Ce("ScanSearch",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m16 16-1.9-1.9",key:"1dq9hf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Ce("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),bt=({imageSrc:n,onCrop:y,onCancel:b})=>{const u=t.useRef(null),r=t.useRef(null),[S,A]=t.useState(!1),[o,w]=t.useState(null),[j,F]=t.useState({x:0,y:0}),[c,f]=t.useState(!0),B=d=>{var i;const x=(i=r.current)==null?void 0:i.getBoundingClientRect();if(!x)return{x:0,y:0};const l=d.touches?d.touches[0].clientX:d.clientX,m=d.touches?d.touches[0].clientY:d.clientY;return{x:l-x.left,y:m-x.top}},k=d=>{const x=B(d);F(x),w({x:x.x,y:x.y,w:0,h:0}),A(!0)},G=d=>{if(!S)return;const x=B(d);w({x:Math.min(j.x,x.x),y:Math.min(j.y,x.y),w:Math.abs(x.x-j.x),h:Math.abs(x.y-j.y)})},O=()=>A(!1);t.useEffect(()=>{n&&f(!0)},[n]);const P=()=>{if(r.current&&u.current){const d=u.current.naturalWidth/u.current.naturalHeight;let x=Math.min(window.innerWidth*.9,600),l=x/d;r.current.width=x,r.current.height=l,w(null);const m=r.current.getContext("2d");m&&(m.drawImage(u.current,0,0,x,l),m.fillStyle="rgba(0, 0, 0, 0.3)",m.fillRect(0,0,x,l)),setTimeout(()=>f(!1),600)}};t.useEffect(()=>{if(!r.current||!u.current||c)return;const d=r.current.getContext("2d");d&&(d.clearRect(0,0,r.current.width,r.current.height),d.drawImage(u.current,0,0,r.current.width,r.current.height),d.fillStyle="rgba(0, 0, 0, 0.5)",d.fillRect(0,0,r.current.width,r.current.height),o&&o.w>0?(d.clearRect(o.x,o.y,o.w,o.h),d.drawImage(u.current,0,0,u.current.width,u.current.height,0,0,r.current.width,r.current.height),d.fillStyle="rgba(0, 0, 0, 0.7)",d.fillRect(0,0,r.current.width,o.y),d.fillRect(0,o.y+o.h,r.current.width,r.current.height-(o.y+o.h)),d.fillRect(0,o.y,o.x,o.h),d.fillRect(o.x+o.w,o.y,r.current.width-(o.x+o.w),o.h),d.strokeStyle="#00ff00",d.lineWidth=2,d.setLineDash([6]),d.strokeRect(o.x,o.y,o.w,o.h)):(d.font="bold 14px sans-serif",d.fillStyle="white",d.textAlign="center",d.fillText("Drag to select text",r.current.width/2,r.current.height/2)))},[o,c]);const M=()=>{if(!o||!u.current||o.w<10){if(u.current&&r.current){u.current.naturalWidth/r.current.width,u.current.naturalHeight/r.current.height,w({x:0,y:0,w:r.current.width,h:r.current.height}),setTimeout(()=>M(),100);return}return}const d=r.current,x=u.current;if(!d)return;const l=x.naturalWidth/d.width,m=x.naturalHeight/d.height,i=document.createElement("canvas");i.width=o.w*l,i.height=o.h*m;const E=i.getContext("2d");E==null||E.drawImage(x,o.x*l,o.y*m,o.w*l,o.h*m,0,0,i.width,i.height),i.toBlob(U=>{U&&y(U)},"image/jpeg")};return e.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/95 flex flex-col items-center justify-center p-4 backdrop-blur-sm",children:[c?e.jsxs("div",{className:"flex flex-col items-center animate-fade-in-up",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(ut,{className:"w-16 h-16 text-green-500 animate-pulse"}),e.jsx("div",{className:"absolute inset-0 bg-green-500/20 blur-xl rounded-full animate-ping"})]}),e.jsx("h3",{className:"text-white font-bold text-lg tracking-widest",children:"SCANNING PAGE..."}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Analyzing text structure"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-800 px-6 py-2 rounded-full mb-4 flex items-center gap-2 shadow-lg border border-slate-700 animate-fade-in-up",children:[e.jsx(mt,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-white text-sm font-bold",children:"Select the area to read"})]}),e.jsx("div",{className:"relative max-h-[70vh] overflow-hidden border-2 border-slate-700 rounded-lg bg-black shadow-2xl",children:e.jsx("canvas",{ref:r,onMouseDown:k,onMouseMove:G,onMouseUp:O,onTouchStart:k,onTouchMove:G,onTouchEnd:O,className:"cursor-crosshair block touch-none"})}),e.jsxs("div",{className:"flex gap-4 mt-6 w-full max-w-sm",children:[e.jsx(V,{variant:"secondary",onClick:b,className:"flex-1 border-slate-600 text-slate-300 hover:bg-slate-800",children:"Discard"}),e.jsxs(V,{onClick:M,className:"flex-1 bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-900/20",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"})," ",o&&o.w>10?"Crop Selection":"Use Full Page"]})]})]}),e.jsx("img",{ref:u,src:n,className:"hidden",onLoad:P})]})},gt=({classId:n})=>{const[y,b]=t.useState([]),[u,r]=t.useState(!1),[S,A]=t.useState(!1),[o,w]=t.useState(null),[j,F]=t.useState([]),[c,f]=t.useState(!1),[B,k]=t.useState(!1),[G,O]=t.useState(!1),[P,M]=t.useState("SCAN"),[d,x]=t.useState(""),[l,m]=t.useState(5),[i,E]=t.useState("From Book Only"),[U,xe]=t.useState("Malayalam"),[J,Z]=t.useState([]),[v,Y]=t.useState(!1),[K,me]=t.useState(!1),[ae,Q]=t.useState(null),[he,ue]=t.useState(0),[q,je]=t.useState([]),[Ne,we]=t.useState([]),[ve,ke]=t.useState(!1),[ee,le]=t.useState(""),[re,ne]=t.useState("CLASS_TEST"),[ye,s]=t.useState(""),[C,a]=t.useState(""),[p,g]=t.useState(""),[I,D]=t.useState(30),[R,oe]=t.useState({shuffleQuestions:!1,showResultImmediately:!0}),[L,_]=t.useState([{id:"1",text:"",options:["","","",""],correctOptionIndex:0,marks:1}]);t.useEffect(()=>{te()},[]);const pe=h=>{if(h.target.files&&h.target.files.length>0){const $=new FileReader;$.onload=H=>{var W;(W=H.target)!=null&&W.result&&(Q(H.target.result),k(!1))},$.readAsDataURL(h.target.files[0])}},be=async()=>{if(P==="TOPIC"&&!d)return alert("Please enter a topic.");if(P==="SCAN"&&J.length===0)return alert("Please upload at least one page.");if(!confirm("Generate Questions using AI? This will cost 5 Credits."))return;Y(!0);const h=await N.deductCredits(5,"AI Question Generation",void 0,"TEACHER",{type:P,topic:d});if(!h.success){Y(!1),alert("Request Failed: "+h.message);return}const $=h.transactionId;try{const H=new He({apiKey:void 0}),W="gemini-2.5-flash",ie=l+3,de=[];let ge=`Generate ${ie} multiple choice questions. Language: ${U}. Provide JSON output with 'text', 'options' (array of 4 strings), 'correctOptionIndex' (0-3 number), and 'marks' (default 1).`;i==="From Book Only"?ge+=" STRICT INSTRUCTION: Generate questions ONLY using the text content found in the provided images.":ge+=` The questions should be appropriate for ${i} level students.`,P==="SCAN"?(J.forEach(Se=>{de.push({inlineData:{mimeType:"image/jpeg",data:Se.split(",")[1]}})}),ge+=" Analyze the images thoroughly. Focus on key facts."):ge+=` The topic is: "${d}".`,de.push({text:ge});const $e=await H.models.generateContent({model:W,contents:{parts:de},config:{responseMimeType:"application/json",responseSchema:{type:se.ARRAY,items:{type:se.OBJECT,properties:{text:{type:se.STRING},options:{type:se.ARRAY,items:{type:se.STRING}},correctOptionIndex:{type:se.INTEGER},marks:{type:se.INTEGER}}}}}}),Te=JSON.parse($e.text||"[]");if(Array.isArray(Te)&&Te.length>0){const Se=Te.map(ce=>({id:Math.random().toString(36).substr(2,9),text:ce.text,options:ce.options,correctOptionIndex:ce.correctOptionIndex,marks:ce.marks||1}));_(ce=>[...ce,...Se]),k(!1),Z([]),x(""),alert(`${Se.length} AI Questions Added!`)}else throw new Error("Invalid AI Response (Empty)")}catch{$?(await N.refundCredits($,"AI Generation Failed"),alert("AI Generation failed. Credits have been refunded.")):alert("AI Failed.")}finally{Y(!1)}},te=async()=>{const h=await N.getExamsForClass(n);b(h)},X=async()=>{if(!ee||!C||!p)return alert("Please fill all details");A(!0);const h=await N.createExam({classId:n,title:ee,examType:re,description:ye,startTime:new Date(C).toISOString(),endTime:new Date(p).toISOString(),durationMinutes:I,questions:L,settings:R});A(!1),h.success?(r(!1),te(),le(""),_([{id:"1",text:"",options:["","","",""],correctOptionIndex:0,marks:1}])):alert(h.message)};return u?e.jsxs("div",{className:"max-w-3xl mx-auto animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Create Exam"}),e.jsx(V,{variant:"secondary",onClick:()=>r(!1),children:"Cancel"})]}),e.jsxs(z,{className:"mb-6 border-t-4 border-t-blue-600",children:[e.jsx(T,{placeholder:"Exam Title",value:ee,onChange:h=>le(h.target.value)}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"Start Time"}),e.jsx(T,{type:"datetime-local",value:C,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"End Time"}),e.jsx(T,{type:"datetime-local",value:p,onChange:h=>g(h.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"Duration (Mins)"}),e.jsx(T,{type:"number",value:I,onChange:h=>D(parseInt(h.target.value))})]})]}),e.jsxs("p",{className:"text-[10px] text-orange-500 mt-2 flex items-center gap-1 font-bold",children:[e.jsx(Be,{className:"w-3 h-3"})," Warning: V9 System prevents scheduling two exams at the same time."]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-slate-300",children:["Questions (",L.length,")"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>k(!0),className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-xs font-bold shadow-lg flex items-center gap-2 hover:scale-105 transition-transform",children:[e.jsx(Ee,{className:"w-4 h-4 text-yellow-300"})," AI Generator ",e.jsx("span",{className:"bg-white/20 px-1 rounded text-[9px]",children:"5 Credits"})]})})]}),e.jsx("div",{className:"space-y-4 mb-6",children:L.map((h,$)=>e.jsxs(z,{className:"relative",children:[e.jsx("button",{onClick:()=>{const H=[...L];H.splice($,1),_(H)},className:"absolute top-2 right-2 text-slate-300 hover:text-red-500",children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsxs("label",{className:"text-xs font-bold text-slate-400 mb-1 block",children:["Question ",$+1]}),e.jsx(T,{className:"mb-3 font-bold",value:h.text,onChange:H=>{const W=[...L];W[$].text=H.target.value,_(W)},placeholder:"Question Text"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:h.options.map((H,W)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"radio",name:`q-${h.id}`,checked:h.correctOptionIndex===W,onChange:()=>{const ie=[...L];ie[$].correctOptionIndex=W,_(ie)},className:"w-4 h-4 accent-green-600 cursor-pointer"}),e.jsx(T,{className:"text-sm h-9",value:H,onChange:ie=>{const de=[...L];de[$].options[W]=ie.target.value,_(de)},placeholder:`Option ${W+1}`})]},W))})]},h.id))}),e.jsxs("div",{className:"flex gap-4 sticky bottom-4 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur p-2 rounded-2xl border shadow-xl",children:[e.jsx("button",{onClick:()=>_([...L,{id:Date.now().toString(),text:"",options:["","","",""],correctOptionIndex:0,marks:1}]),className:"flex-1 py-3 border-2 border-dashed rounded-xl font-bold text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:"Add Question"}),e.jsx(V,{onClick:X,disabled:S,className:"flex-1 bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/30",children:S?"Saving...":"Save Exam"})]}),B&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4",children:e.jsxs(z,{className:"max-w-md w-full",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-purple-500"})," AI Question Generator"]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-200 dark:border-yellow-800 mb-4 flex items-center gap-3",children:[e.jsx(Ge,{className:"w-5 h-5 text-yellow-600 fill-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-yellow-800 dark:text-yellow-200",children:"Costs 5 Credits"}),e.jsx("p",{className:"text-[10px] text-yellow-700 dark:text-yellow-300",children:"Secure Auto-Refund on failure."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>M("SCAN"),className:`flex-1 py-2 text-xs font-bold rounded transition-all ${P==="SCAN"?"bg-white dark:bg-slate-800 shadow text-blue-600":"text-slate-500"}`,children:"Scan Page"}),e.jsx("button",{onClick:()=>M("TOPIC"),className:`flex-1 py-2 text-xs font-bold rounded transition-all ${P==="TOPIC"?"bg-white dark:bg-slate-800 shadow text-blue-600":"text-slate-500"}`,children:"Topic"})]}),P==="TOPIC"&&e.jsx(T,{placeholder:"Enter Topic (e.g. Photosynthesis)",value:d,onChange:h=>x(h.target.value)}),P==="SCAN"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block p-4 border-2 border-dashed rounded-xl text-center cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors",children:[e.jsx(De,{className:"mx-auto h-8 w-8 text-slate-400 mb-2"}),e.jsx("span",{className:"text-xs text-slate-500 font-bold block",children:"Take Photo / Upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:pe})]}),J.length>0&&e.jsxs("p",{className:"text-center text-xs text-green-500 font-bold",children:[J.length," images scanned"]})]}),e.jsx(V,{onClick:be,disabled:v,className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-xl",children:v?"Analyzing & Generating...":"Generate (5 Credits)"}),e.jsx("button",{onClick:()=>k(!1),className:"w-full text-xs text-slate-500 mt-2 hover:text-slate-700",children:"Cancel"})]})]})}),ae&&e.jsx(bt,{imageSrc:ae,onCancel:()=>{Q(null),k(!0)},onCrop:h=>{const $=new FileReader;$.readAsDataURL(h),$.onloadend=()=>{$.result&&(Z(H=>[...H,$.result]),Q(null),k(!0))}}})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Exams"}),e.jsxs(V,{onClick:()=>r(!0),className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"})," New Exam"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[y.map(h=>e.jsxs(z,{className:"relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx(Ye,{className:"w-16 h-16"})}),e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-white",children:h.title}),e.jsxs("p",{className:"text-xs text-slate-500 mb-3",children:[h.questions.length," Questions â€¢ ",h.durationMinutes," Mins"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:"text-[10px] font-bold px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-500",children:new Date(h.startTime)>new Date?"Scheduled":new Date(h.endTime)<new Date?"Ended":"Live"})})]},h.id)),y.length===0&&e.jsx("div",{className:"col-span-full text-center py-10 text-slate-400",children:"No exams created yet."})]})]})},ft=({user:n,students:y,pendingAdmissions:b,stats:u,sortingMethod:r,onRefresh:S,onDeleteStudent:A,onAdmissionAction:o,onCleanJunk:w})=>{const[j,F]=t.useState(!1),[c,f]=t.useState({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),[B,k]=t.useState(!1),[G,O]=t.useState({name:!1,dob:!1,gender:!1}),[P,M]=t.useState(""),[d,x]=t.useState(""),[l,m]=t.useState(!1),[i,E]=t.useState(!1),[U,xe]=t.useState(null),[J,Z]=t.useState(!1),[v,Y]=t.useState({}),[K,me]=t.useState(""),[ae,Q]=t.useState([]),[he,ue]=t.useState(!1),q=n.submissionStatus==="SUBMITTED"||n.submissionStatus==="APPROVED";t.useEffect(()=>{(async()=>{const C=await N.getClasses();Q(C.filter(a=>a.id!==n.id))})()},[n.id]);const je=t.useMemo(()=>{const s=r||"BOYS_FIRST";if(s==="BOYS_FIRST"||s==="GIRLS_FIRST"){const C=y.filter(p=>p.gender==="Male").sort((p,g)=>(p.rollNo||9999)-(g.rollNo||9999)),a=y.filter(p=>p.gender!=="Male").sort((p,g)=>(p.rollNo||9999)-(g.rollNo||9999));return s==="BOYS_FIRST"?[...C,...a]:[...a,...C]}return[...y].sort((C,a)=>s==="ROLL_ONLY"?(C.rollNo||9999)-(a.rollNo||9999):s==="NAME_ONLY"?C.name.localeCompare(a.name):0)},[y,r]),Ne=s=>{c[s]?O(C=>({...C,[s]:!1})):O(C=>({...C,[s]:!0}))},we=async s=>{if(!s.target.files||s.target.files.length===0)return;if(!n.isPro){alert("Photo upload is an Elite/Pro feature.");return}E(!0);const C=s.target.files[0],a=await N.uploadImage(C,"students");E(!1),a.success&&a.publicUrl?(f(p=>({...p,photoUrl:a.publicUrl})),m(!1)):alert("Upload failed: "+a.message)},ve=async s=>{if(s.preventDefault(),q){alert("Class is locked/submitted. Ask admin to unlock before adding students.");return}x(""),M(""),O({name:!1,dob:!1,gender:!1});let C=!1;if(c.name||(O(g=>({...g,name:!0})),C=!0),c.dob||(O(g=>({...g,dob:!0})),C=!0),c.gender||(O(g=>({...g,gender:!0})),C=!0),C){x("âš ï¸ Please fill Name, DOB & Gender!");return}k(!0);const a={...c,fatherName:c.fatherName||"Not Entered",motherName:c.motherName||"Not Entered",addedBy:n.teacherName||"Class Teacher"};if(!a.photoUrl){const g=a.name||"Felix";a.photoUrl=`https://api.dicebear.com/7.x/avataaars/svg?seed=${g}&gender=${a.gender==="Female"?"female":"male"}`}const p=await N.createStudent(n.id,a);k(!1),p.success?(M(`âœ… ${c.name} Added!`),f({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),S(),setTimeout(()=>M(""),2500)):alert("Failed: "+p.message)},ke=s=>{xe(s),Y({...s}),Z(!1),me("")},ee=async()=>{if(q)return alert("Class is locked.");await N.updateStudentDetails(U.id,v),o(U.id,"APPROVE"),re(null)},le=async()=>{if(!K||!U)return;ue(!0);const s=await N.transferStudentAdmission(U.id,K);ue(!1),s.success?(alert("Student Transferred Successfully!"),xe(null),S()):alert("Transfer failed: "+s.message)},re=s=>{xe(s),Z(!1),Y({})},ne=`${window.location.origin}/#/register?schoolId=${n.schoolId}&classId=${n.id}`,ye=`Dear Parents,

Admission for *${n.name}* is now open.
Please register your child using the link below:

ðŸ”— ${ne}

Thank you,
${n.teacherName||"Class Teacher"}`;return e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 animate-fade-in-up",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs(z,{className:"bg-gradient-to-br from-indigo-600 to-purple-700 text-white border-none relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:e.jsx(Me,{className:"w-24 h-24"})}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Smart Invite"}),e.jsx("p",{className:"text-xs text-indigo-200 mb-4",children:"Share this link with parents for self-registration."}),e.jsx("div",{className:"bg-black/20 p-2 rounded-lg text-[10px] font-mono mb-4 break-all truncate border border-white/10",children:ne}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>window.open(`https://wa.me/?text=${encodeURIComponent(ye)}`,"_blank"),className:"flex-1 bg-[#25D366] hover:bg-[#20bd5a] text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1 shadow-lg",children:"WhatsApp"}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(ne),className:"flex-1 bg-white/10 hover:bg-white/20 text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1",children:"Copy Link"})]})]}),e.jsxs(z,{className:"bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-white flex items-center gap-2 text-sm mb-3",children:[e.jsx(st,{className:"w-4 h-4 text-orange-500"})," Class Health"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-2",children:[e.jsx("span",{className:"text-slate-500",children:"Verified Students"}),e.jsx("span",{className:"font-bold text-green-600",children:u.total})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-3",children:[e.jsx("span",{className:"text-slate-500",children:"Pending/Ghost"}),e.jsx("span",{className:"font-bold text-red-500",children:b.length})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mb-3",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${u.total/(u.total+b.length||1)*100}%`}})}),e.jsxs("button",{onClick:w,disabled:b.length===0||q,className:"w-full text-xs flex items-center justify-center gap-1 bg-white dark:bg-slate-800 border border-red-200 dark:border-red-900/50 text-red-600 dark:text-red-400 py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/20 disabled:opacity-50",children:[e.jsx(pt,{className:"w-3 h-3"})," Delete All Unverified"]})]}),e.jsxs(z,{className:`border-t-4 ${q?"border-t-slate-400 opacity-80":"border-t-blue-500"} relative overflow-hidden`,children:[q&&e.jsxs("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-950/60 backdrop-blur-[1px] z-10 flex flex-col items-center justify-center text-center",children:[e.jsx(Fe,{className:"w-8 h-8 text-slate-500 mb-2"}),e.jsx("p",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Class Locked"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Results submitted. Cannot add students."})]}),P&&e.jsxs("div",{className:"absolute inset-0 z-20 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(fe,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:P})]}),d&&e.jsx("div",{className:"mb-4 bg-red-50 text-red-600 p-2 rounded text-xs text-center border border-red-100",children:d}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(Re,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Add Student"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Manual Entry"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 flex gap-4 items-center bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"relative w-16 h-16 shrink-0 rounded-full overflow-hidden border-2 border-slate-200 shadow-sm",children:c.photoUrl?e.jsx("img",{src:c.photoUrl,className:"w-full h-full object-cover"}):e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${c.name||"Felix"}&gender=${c.gender==="Female"?"female":"male"}`,className:"w-full h-full opacity-80"})}),e.jsx("div",{className:"flex-1 space-y-2",children:l?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"cursor-pointer bg-slate-200 dark:bg-slate-700 px-3 py-1 rounded text-[10px] font-bold text-center block",children:[i?"Uploading...":"Choose File",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:we,disabled:i})]}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"text-[10px] text-red-500",children:"Cancel"})]}):e.jsxs("div",{children:[e.jsx(T,{className:"text-xs h-8",placeholder:"Paste Image URL...",value:c.photoUrl,onChange:s=>f({...c,photoUrl:s.target.value})}),n.isPro&&e.jsx("button",{type:"button",onClick:()=>m(!0),className:"text-[10px] text-blue-600 font-bold underline mt-1 block",children:"Or Upload File"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"FULL NAME *"}),e.jsx("input",{value:c.name,onChange:s=>f({...c,name:s.target.value.toUpperCase()}),onBlur:()=>Ne("name"),className:`w-full bg-white dark:bg-slate-800 font-bold rounded-lg px-4 py-2.5 outline-none border-2 ${G.name?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"Gender *"}),e.jsxs("select",{className:"w-full bg-white dark:bg-slate-800 px-3 py-2.5 outline-none font-medium border-2 rounded-lg",value:c.gender,onChange:s=>f({...c,gender:s.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Boy"}),e.jsx("option",{value:"Female",children:"Girl"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"DOB *"}),e.jsx("input",{type:"date",value:c.dob,onChange:s=>f({...c,dob:s.target.value}),className:`w-full bg-white dark:bg-slate-800 font-medium rounded-lg px-3 py-2 outline-none border-2 ${G.dob?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(T,{className:"text-sm font-mono",placeholder:"Reg No (Auto)",value:c.regNo,onChange:s=>f({...c,regNo:s.target.value})}),e.jsx(T,{type:"number",className:"text-sm font-mono",placeholder:"Roll No",value:c.rollNo,onChange:s=>f({...c,rollNo:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(T,{className:"text-sm",placeholder:"Father",value:c.fatherName,onChange:s=>f({...c,fatherName:s.target.value})}),e.jsx(T,{className:"text-sm",placeholder:"Mother",value:c.motherName,onChange:s=>f({...c,motherName:s.target.value})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onClick:ve,disabled:B,className:"w-full py-3 text-sm font-bold",children:B?"Saving...":"Save & Add Next"})})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[b.length>0&&e.jsxs(z,{className:"bg-orange-50 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-200 flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"})," Pending Admissions (",b.length,")"]}),e.jsx("span",{className:"text-[10px] bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded",children:"Action Required"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:b.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 rounded-xl shadow-sm border border-slate-100 dark:border-slate-800 flex items-center justify-between group hover:border-orange-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.name}`,className:"w-10 h-10 rounded-full object-cover bg-slate-100"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm text-slate-800 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-[10px] text-slate-500",children:["Applied: ",new Date().toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>ke(s),className:"bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-400 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:"Review"})]},s.id))})]}),e.jsxs(z,{className:"p-0 overflow-hidden min-h-[400px] relative",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-500"})," Class List (",y.length,")"]}),e.jsxs(V,{variant:"secondary",onClick:()=>F(!0),className:"text-xs flex items-center gap-1",disabled:q,children:[e.jsx(at,{className:"w-3 h-3"})," Register"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10",children:"Roll"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3 w-24",children:"Reg No"}),e.jsx("th",{className:"p-3 w-24",children:"DOB"}),e.jsx("th",{className:"p-3 w-20 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:je.map(s=>e.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-center text-slate-500",children:s.rollNo||"-"}),e.jsx("td",{className:"p-3 text-slate-800 dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold",children:[s.photoUrl&&e.jsx("img",{src:s.photoUrl,className:"w-6 h-6 rounded-full object-cover"}),s.name,s.isPremium&&e.jsx(Ve,{className:"w-3 h-3 text-yellow-500"})]})}),e.jsx("td",{className:"p-3 font-mono text-slate-600 dark:text-slate-300",children:s.regNo}),e.jsx("td",{className:"p-3 text-slate-500 font-mono",children:Pe(s.dob)}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>A(s.id,s.name),disabled:q,className:"p-2 text-slate-400 hover:text-red-500 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(Ae,{className:"w-4 h-4"})})})]},s.id))})]})})]})]}),U&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in-up",children:e.jsxs(z,{className:"w-full max-w-2xl bg-white dark:bg-slate-900 border-t-4 border-t-blue-600 max-h-[90vh] overflow-y-auto flex flex-col p-0",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-950",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Review Application"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Verify details before approving."})]}),e.jsx("button",{onClick:()=>re(null),className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(Ie,{className:"w-5 h-5 text-slate-500"})})]}),e.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:U.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${U.name}`,className:"w-32 h-32 rounded-full object-cover mx-auto border-4 border-white dark:border-slate-800 shadow-lg bg-slate-100"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2",children:"Applicant Photo"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-900/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-bold text-blue-800 dark:text-blue-300 text-sm",children:"Student Details"}),e.jsxs("button",{onClick:()=>Z(!J),className:"text-xs text-blue-600 underline flex items-center gap-1",children:[e.jsx(lt,{className:"w-3 h-3"})," ",J?"Cancel Edit":"Edit"]})]}),e.jsx("div",{className:"space-y-2 text-sm",children:J?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-8 text-xs",value:v.name,onChange:s=>Y({...v,name:s.target.value.toUpperCase()}),placeholder:"Name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(T,{className:"h-8 text-xs",value:v.regNo,onChange:s=>Y({...v,regNo:s.target.value}),placeholder:"Reg No"}),e.jsx("input",{type:"date",className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:v.dob,onChange:s=>Y({...v,dob:s.target.value})})]}),e.jsxs("select",{className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:v.gender,onChange:s=>Y({...v,gender:s.target.value}),children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Name:"})," ",e.jsx("span",{className:"font-bold",children:v.name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Reg No:"})," ",e.jsx("span",{className:"font-mono",children:v.regNo||"-"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"DOB:"})," ",e.jsx("span",{children:Pe(v.dob)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Gender:"})," ",e.jsx("span",{children:v.gender})]})]})})]})]}),e.jsxs("div",{className:"space-y-6 flex flex-col h-full",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-300 text-sm mb-3",children:"Parent Information"}),e.jsx("div",{className:"space-y-2 text-sm",children:J?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-8 text-xs",value:v.fatherName,onChange:s=>Y({...v,fatherName:s.target.value}),placeholder:"Father's Name"}),e.jsx(T,{className:"h-8 text-xs",value:v.motherName,onChange:s=>Y({...v,motherName:s.target.value}),placeholder:"Mother's Name"}),e.jsx(T,{className:"h-8 text-xs",value:v.phone,onChange:s=>Y({...v,phone:s.target.value}),placeholder:"Phone"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Father:"})," ",e.jsx("span",{className:"font-bold",children:v.fatherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Mother:"})," ",e.jsx("span",{children:v.motherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Phone:"})," ",e.jsx("span",{children:v.phone})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Address:"})," ",e.jsx("span",{className:"text-xs",children:v.address||"-"})]})]})})]}),e.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Wrong Class? Transfer Request"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ue,{className:"h-9 text-xs py-0",value:K,onChange:s=>me(s.target.value),children:[e.jsx("option",{value:"",children:"Select Target Class"}),ae.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{onClick:le,disabled:!K||he,className:"bg-purple-100 text-purple-700 px-3 rounded-lg text-xs font-bold hover:bg-purple-200 transition-colors whitespace-nowrap",children:he?"Moving...":e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-3 h-3 inline mr-1"})," Move"]})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>o(U.id,"REJECT"),className:"flex-1 py-3 border border-red-200 text-red-600 rounded-xl font-bold text-sm hover:bg-red-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"})," Reject"]}),e.jsxs("button",{onClick:ee,disabled:q,className:"flex-[2] py-3 bg-green-600 text-white rounded-xl font-bold text-sm hover:bg-green-700 shadow-lg shadow-green-500/30 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx(fe,{className:"w-4 h-4"})," Approve Admission"]})]})]})]})]})]})})]})},jt=({students:n,marks:y,subjects:b,isSubmitted:u,loading:r,onMarkChange:S,onSaveAll:A,onSubmitResults:o})=>{const w=[...n].sort((x,l)=>(x.rollNo||9999)-(l.rollNo||9999)),[j,F]=t.useState("TERM"),[c,f]=t.useState(!1),[B,k]=t.useState(!1),[G,O]=t.useState(null);t.useEffect(()=>{(async()=>{const l=await N.getSchoolConfig();l!=null&&l.allowTeacherDirectPublish&&f(!0)})()},[]);const P=["CLASS_TEST","REVISION"].includes(j),M=async()=>{if(P&&c){if(!confirm(`Directly publish ${j} results? Parents will see this immediately.`))return;k(!0),o()}else o()},d=(x,l,m)=>{if(O(null),m===""||m.toUpperCase()==="AB"||m.toUpperCase()==="A"){S(x,l,m);return}const i=parseFloat(m);if(isNaN(i))return;const E=b.find(U=>U.name===l);if(E){if(i>E.maxMarks){O(`Cannot enter ${i} for ${l}. Max is ${E.maxMarks}.`);return}if(i<0)return}S(x,l,m)};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative",children:[G&&e.jsxs("div",{className:"absolute top-full left-0 right-0 bg-red-100 text-red-700 text-xs font-bold p-2 text-center border-b border-red-200 z-20 animate-fade-in-up",children:[e.jsx(Qe,{className:"w-3 h-3 inline mr-1"})," ",G]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Assessment Type"}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>F("TERM"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${j==="TERM"?"bg-white dark:bg-slate-800 text-blue-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(nt,{className:"w-4 h-4"})," Term Exam"]}),e.jsxs("button",{onClick:()=>F("CLASS_TEST"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${j==="CLASS_TEST"?"bg-white dark:bg-slate-800 text-purple-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(ot,{className:"w-4 h-4"})," Class Test"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white hidden md:block",children:"Marks Entry"}),u&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded font-bold flex items-center gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"})," Locked"]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs(V,{onClick:A,variant:"secondary",disabled:r||u,className:"flex-1 md:flex-none",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2 inline"})," Save Draft"]}),P&&c?e.jsxs(V,{onClick:M,className:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-500/20 flex-1 md:flex-none",disabled:u,children:[e.jsx(_e,{className:"w-4 h-4 mr-2 inline"})," Publish Result"]}):e.jsx(V,{onClick:o,className:u?"bg-orange-500 hover:bg-orange-600 flex-1 md:flex-none":"bg-blue-600 hover:bg-blue-700 flex-1 md:flex-none",children:u?e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-4 h-4 mr-2 inline"})," Request Unlock"]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2 inline"})," Submit to Admin"]})})]})]}),e.jsx(z,{className:"overflow-x-auto p-0",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 dark:bg-slate-800 text-xs uppercase font-bold text-slate-500 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-3 w-48 sticky left-0 bg-slate-100 dark:bg-slate-800 z-10",children:"Student Name"}),b.map(x=>e.jsxs("th",{className:"p-3 text-center min-w-[80px]",children:[x.name.substring(0,10),e.jsxs("span",{className:"block text-[9px] opacity-60",children:["Max: ",x.maxMarks]})]},x.name)),e.jsx("th",{className:"p-3 w-24 text-center font-black",children:"Total"}),e.jsx("th",{className:"p-3 w-16 text-center",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:w.map(x=>{const l=y[x.id];return l?e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3 text-center font-mono text-slate-500",children:x.rollNo||"-"}),e.jsx("td",{className:"p-3 font-bold text-slate-700 dark:text-slate-200 sticky left-0 bg-white dark:bg-slate-900 z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.name}),b.map(m=>e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"text",className:`w-12 text-center p-1.5 rounded border outline-none font-bold transition-all focus:ring-2 focus:ring-blue-500 ${u?"bg-slate-100 text-slate-500 cursor-not-allowed":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700"}`,value:l.subjects[m.name]||"",onChange:i=>d(x.id,m.name,i.target.value),disabled:u,placeholder:"-"})},m.name)),e.jsx("td",{className:"p-3 text-center font-black text-blue-600 dark:text-blue-400",children:l.total}),e.jsx("td",{className:`p-3 text-center font-bold ${l.grade==="F"?"text-red-500":"text-green-600"}`,children:l.grade})]},x.id):null})})]})})]})},Nt=({onPostNotice:n})=>{const[y,b]=t.useState(""),[u,r]=t.useState(""),[S,A]=t.useState(""),[o,w]=t.useState(!1),[j,F]=t.useState(!1);t.useEffect(()=>{if(o){const f=setTimeout(()=>w(!1),2e3);return()=>clearTimeout(f)}},[o]);const c=async()=>{if(!y||!u){alert("Please enter title and message");return}F(!0);const f=await n(y,u,S);F(!1),f&&(b(""),r(""),A(""),w(!0))};return e.jsx("div",{className:"max-w-md mx-auto animate-fade-in-up",children:e.jsxs(z,{className:"border-t-4 border-t-blue-500 relative overflow-hidden",children:[o&&e.jsxs("div",{className:"absolute inset-0 z-10 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(fe,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:S?"Scheduled!":"Notice Posted!"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(We,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Post Notice"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Inform students & parents"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Title"}),e.jsx(T,{placeholder:"e.g. Exam Schedule",value:y,onChange:f=>b(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Message"}),e.jsx("textarea",{className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-3 text-sm h-32 resize-none",placeholder:"Type here...",value:u,onChange:f=>r(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Schedule for Later (Optional)"}),e.jsx(T,{type:"datetime-local",value:S,onChange:f=>A(f.target.value)})]}),e.jsxs(V,{onClick:c,disabled:j,className:"w-full flex items-center justify-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),j?"Posting...":S?"Schedule Post":"Post Notice"]})]})]})})},wt=({subjects:n,onAddSubject:y,onDeleteSubject:b,canEdit:u})=>{const[r,S]=t.useState({name:"",max:"50",pass:"18"}),[A,o]=t.useState(!1),w=async()=>{if(!r.name)return;o(!0);const j=parseInt(r.max)||50,F=parseInt(r.pass)||18,c=await y(r.name,j,F);o(!1),c&&S({name:"",max:"50",pass:"18"})};return e.jsx("div",{className:"max-w-2xl mx-auto animate-fade-in-up",children:e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded-lg text-purple-600 dark:text-purple-400",children:e.jsx(Je,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white",children:"Manage Subjects"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Add or remove subjects for this class."})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[n.map((j,F)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200",children:j.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Max: ",j.maxMarks," | Pass: ",j.passMarks]})]}),u&&e.jsx("button",{onClick:()=>b(F),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Ae,{className:"w-4 h-4"})})]},F)),n.length===0&&e.jsx("p",{className:"text-center text-slate-400 text-sm",children:"No subjects added."})]}),u?e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-900 p-4 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 mb-3 uppercase",children:"Add New Subject"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(T,{placeholder:"Subject Name (e.g. Maths)",value:r.name,onChange:j=>S({...r,name:j.target.value}),className:"flex-[2]"}),e.jsx("div",{className:"flex-1",children:e.jsx(T,{type:"number",placeholder:"Max",value:r.max,onChange:j=>S({...r,max:j.target.value})})}),e.jsx("div",{className:"flex-1",children:e.jsx(T,{type:"number",placeholder:"Pass",value:r.pass,onChange:j=>S({...r,pass:j.target.value})})})]}),e.jsx(V,{onClick:w,disabled:A,className:"w-full flex justify-center items-center gap-2",children:A?"Adding...":e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-4 h-4"})," Add Subject"]})})]}):e.jsx("div",{className:"text-center p-4 bg-yellow-50 text-yellow-700 text-sm rounded-lg border border-yellow-200",children:"Subject editing is disabled by Admin."})]})})},vt=({students:n,classId:y})=>{const[b,u]=t.useState("DAILY"),[r,S]=t.useState(new Date().toISOString().split("T")[0]),[A,o]=t.useState("Term 1"),[w,j]=t.useState({}),[F,c]=t.useState(!1),[f,B]=t.useState(!1),[k,G]=t.useState(50);t.useEffect(()=>{O()},[b,r,A]);const O=async()=>{c(!0);const l={};b==="DAILY"?((await N.getAttendanceByDate(y,r)).forEach(i=>{l[i.studentId]=i.status}),n.forEach(i=>{l[i.id]||(l[i.id]="PRESENT")})):((await N.getAttendanceByTerm(y,A)).forEach(i=>{l[i.studentId]={present:i.presentDays,total:i.workingDays},i.workingDays&&G(i.workingDays)}),n.forEach(i=>{l[i.id]||(l[i.id]={present:0,total:k})})),j(l),c(!1)},P=l=>{j(m=>{const i=m[l],E=i==="PRESENT"?"ABSENT":i==="ABSENT"?"LATE":"PRESENT";return{...m,[l]:E}})},M=(l,m)=>{const i=parseInt(m)||0;j(E=>({...E,[l]:{present:i,total:k}}))},d=async()=>{B(!0);const l=n.map(i=>({studentId:i.id,classId:y,date:r,status:w[i.id],type:"DAILY"})),m=await N.markDailyAttendance(l);B(!1),m.success?alert("Daily Attendance Saved!"):alert("Failed to save.")},x=async()=>{B(!0);const l=n.map(i=>{var E;return{studentId:i.id,classId:y,term:A,workingDays:k,presentDays:((E=w[i.id])==null?void 0:E.present)||0,status:"PRESENT",type:"SUMMARY"}}),m=await N.saveSummaryAttendance(l);B(!1),m.success?alert("Term Attendance Saved!"):alert("Failed to save.")};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 gap-4",children:[e.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-900 p-1 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>u("DAILY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${b==="DAILY"?"bg-white dark:bg-slate-800 shadow text-blue-600 dark:text-blue-400":"text-slate-500"}`,children:[e.jsx(Xe,{className:"w-4 h-4"})," Daily Tracker"]}),e.jsxs("button",{onClick:()=>u("SUMMARY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${b==="SUMMARY"?"bg-white dark:bg-slate-800 shadow text-purple-600 dark:text-purple-400":"text-slate-500"}`,children:[e.jsx(ht,{className:"w-4 h-4"})," Term Summary"]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[b==="DAILY"?e.jsx(T,{type:"date",value:r,onChange:l=>S(l.target.value),className:"font-bold text-sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(Ue,{value:A,onChange:l=>o(l.target.value),className:"w-32 text-sm py-2",children:[e.jsx("option",{children:"Term 1"}),e.jsx("option",{children:"Term 2"}),e.jsx("option",{children:"Finals"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-900 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsx("span",{className:"text-[10px] text-slate-500 font-bold uppercase whitespace-nowrap",children:"Total Days:"}),e.jsx("input",{type:"number",className:"w-12 bg-transparent text-sm font-bold text-center outline-none",value:k,onChange:l=>G(parseInt(l.target.value)||0)})]})]}),e.jsx(V,{onClick:b==="DAILY"?d:x,disabled:f,className:"bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/20",children:f?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"})," Save"]})})]})]}),e.jsx(z,{className:"p-0 overflow-hidden min-h-[400px]",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-4",children:"Student Name"}),e.jsx("th",{className:"p-4 text-center",children:"Status / Days Present"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:n.map(l=>{var m,i,E;return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-4 text-center text-slate-500 font-mono",children:l.rollNo||"-"}),e.jsx("td",{className:"p-4 font-bold text-slate-700 dark:text-slate-200",children:l.name}),e.jsx("td",{className:"p-4 text-center",children:F?e.jsx("div",{className:"h-8 w-24 bg-slate-100 dark:bg-slate-800 rounded animate-pulse mx-auto"}):b==="DAILY"?e.jsxs("button",{onClick:()=>P(l.id),className:`w-32 py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all ${w[l.id]==="PRESENT"?"bg-green-100 text-green-700 border border-green-200":w[l.id]==="ABSENT"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[w[l.id]==="PRESENT"&&e.jsx(fe,{className:"w-4 h-4"}),w[l.id]==="ABSENT"&&e.jsx(Ze,{className:"w-4 h-4"}),w[l.id]==="LATE"&&e.jsx(ct,{className:"w-4 h-4"}),w[l.id]||"PRESENT"]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"number",className:"w-16 p-2 text-center font-bold bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none",value:((m=w[l.id])==null?void 0:m.present)||0,onChange:U=>M(l.id,U.target.value)})}),e.jsxs("span",{className:"text-slate-400 text-xs",children:["/ ",k]}),e.jsxs("span",{className:`text-xs font-bold ml-2 ${((i=w[l.id])==null?void 0:i.present)/k<.75?"text-red-500":"text-green-500"}`,children:[k>0?Math.round(((E=w[l.id])==null?void 0:E.present)/k*100):0,"%"]})]})})]},l.id)})})]})})]})},Ft=({user:n})=>{const y=Ke(),[b,u]=t.useState("students"),[r,S]=t.useState([]),[A,o]=t.useState([]),[w,j]=t.useState({}),[F,c]=t.useState(!1),[f,B]=t.useState(n.subjects),[k,G]=t.useState(n.submissionStatus==="SUBMITTED"),[O,P]=t.useState(!1),[M,d]=t.useState({name:n.teacherName||"",photo:n.teacherPhoto||""}),[x,l]=t.useState(!1),[m,i]=t.useState(null),[E,U]=t.useState(!1),[xe,J]=t.useState(""),[Z,v]=t.useState([]),[Y,K]=t.useState([]),[me,ae]=t.useState(!1);t.useEffect(()=>{Q(),he()},[]);const Q=async()=>{c(!0);const a=await N.getSchoolConfig();i(a),P((a==null?void 0:a.allowTeacherSubjectEdit)??!1);const p=(a==null?void 0:a.feeManagerRole)||"ADMIN",I=(await N.getFeeStructures(n.id)).filter(L=>L.collectedBy==="TEACHER"||L.collectedBy==="BOTH"||p==="TEACHER"||p==="HYBRID");K(I),ae(I.length>0);const D=await N.getStudentsByClass(n.id);S(D);const R={};for(const L of D){const _=await N.getMarks(L.id,"Term 1");_?R[L.id]=_:R[L.id]={studentId:L.id,subjects:f.reduce((pe,be)=>({...pe,[be.name]:0}),{}),total:0,grade:"F",term:"Term 1"}}j(R);const oe=await N.getPendingAdmissions(n.id);o(oe),oe.length>0&&((a==null?void 0:a.admissionApprover)==="TEACHER"||(a==null?void 0:a.admissionApprover)==="BOTH"||!(a!=null&&a.admissionApprover))&&u("students"),c(!1)},he=async()=>{const a=await N.getAssessmentPrograms("TEACHER",n.id);v(a)},ue=(a,p,g)=>{if(k)return;let I="";if(g!==""){const D=g.toUpperCase(),R=parseInt(g);if(isNaN(R)&&D!=="A"&&D!=="AB")return;D==="A"||D==="AB"?I=D:I=R}j(D=>{const R={...D[a]};R.subjects={...R.subjects,[p]:I};const oe=Object.values(R.subjects).reduce((te,X)=>te+(typeof X=="number"?X:0),0);R.total=oe;let L=0,_=!1;Object.keys(R.subjects).forEach(te=>{const X=f.find(h=>h.name===te);if(X){L+=X.maxMarks;const h=R.subjects[te];(typeof h=="number"?h:0)<X.passMarks&&(_=!0)}});const{grade:pe,resultStatus:be}=tt(oe,L,_);return R.grade=pe,R.resultStatus=be,{...D,[a]:R}})},q=async()=>{c(!0);for(const a of Object.values(w))await N.saveMarks(a);c(!1),alert("All marks saved successfully!")},je=async()=>{if(k){const p=prompt("Request Admin to unlock this class? (Optional: Enter reason)");p!==null&&((await N.createSystemFeedback(`Unlock Request for Class ${n.name}. Reason: ${p}`,"SUPPORT",n.teacherName||"Teacher")).success?alert("Unlock Request Sent to Admin!"):alert("Failed to send request."));return}if(!window.confirm("Verify & Submit to Admin?"))return;(await N.toggleClassSubmission(n.id,!0)).success&&(G(!0),alert("Submitted Successfully!"))},Ne=async(a,p)=>{if(p==="APPROVE"){const g=await N.verifyStudent(a,n.teacherName||"Teacher");g.success?(Q(),o(I=>I.filter(D=>D.id!==a))):alert(g.message)}else{if(!window.confirm("Reject this admission?"))return;(await N.rejectAdmission(a)).success&&o(I=>I.filter(D=>D.id!==a))}},we=async(a,p)=>{if(!window.confirm(`Delete ${p}?`))return;const g=await N.deleteStudent(a);g.success?Q():alert("Failed: "+g.message)},ve=async()=>{if(!window.confirm("Warning: This will delete all Unverified (Ghost) students in your class. Continue?"))return;(await N.deleteUnverifiedStudents(n.id)).success?(alert("Cleaned successfully!"),Q()):alert("Failed to clean.")},ke=async(a,p,g)=>{const I=[...f,{name:a,maxMarks:p,passMarks:g}];return(await N.updateClassSubjects(n.id,I)).success?(B(I),Q(),!0):(alert("Failed to add subject"),!1)},ee=async a=>{if(!window.confirm("Delete this subject? Existing marks will be hidden."))return;const p=[...f];p.splice(a,1),(await N.updateClassSubjects(n.id,p)).success&&(B(p),Q())},le=async(a,p,g)=>{const I=n.teacherName||n.name||"Teacher",D=g?new Date(g).toISOString():void 0,R=await N.createCampusPost(n.schoolId||"",I,p,"TEACHER","NOTICE",a,D);return R.success?!0:(alert("Failed: "+R.message),!1)},re=async()=>{(await N.updateClassDetails(n.id,{teacherName:M.name,teacherPhoto:M.photo})).success?l(!1):alert("Failed update")},ne=async a=>{if(!a.target.files||a.target.files.length===0)return;if(!n.isPro){alert("Photo upload is an Elite/Pro feature.");return}const p=a.target.files[0],g=await N.uploadImage(p,"teachers");g.success&&g.publicUrl?d(I=>({...I,photo:g.publicUrl})):alert("Upload failed: "+g.message)},s={total:r.length,male:r.filter(a=>a.gender==="Male").length,female:r.filter(a=>a.gender==="Female").length},C=()=>{if(b==="students")return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:[s.male," B"]})}),e.jsx("div",{className:"flex items-center gap-1 bg-pink-50 dark:bg-pink-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-pink-700 dark:text-pink-300",children:[s.female," G"]})})]});if(b==="marks"){const a=Object.values(w).filter(p=>p.total>0).length;return e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded text-xs",children:[e.jsx("span",{className:"text-slate-500 font-bold uppercase",children:"Progress:"}),e.jsxs("span",{className:`font-bold ${a===s.total?"text-green-600":"text-slate-800"}`,children:[a," / ",s.total]})]})}return null};return e.jsxs("div",{className:"pb-20 relative animate-fade-in-up",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 p-3 mb-4 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsxs("div",{className:"relative group shrink-0",children:[M.photo?e.jsx("img",{src:M.photo,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900 rounded-lg flex items-center justify-center text-blue-600 dark:text-blue-300",children:e.jsx(dt,{className:"w-6 h-6"})}),x&&e.jsxs("label",{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center cursor-pointer",children:[e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:ne}),e.jsx(De,{className:"w-4 h-4 text-white"})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-black text-blue-600 dark:text-blue-400",children:n.name}),x?e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{className:"bg-slate-50 border rounded px-1 text-xs",value:M.name,onChange:a=>d({...M,name:a.target.value})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:re,className:"text-[10px] bg-green-100 text-green-700 px-2 rounded",children:"Save"}),e.jsx("button",{onClick:()=>U(!0),className:"text-[10px] bg-yellow-100 text-yellow-700 px-2 rounded",children:"Pass"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:M.name||"Class Teacher"}),e.jsx("button",{onClick:()=>l(!0),className:"text-slate-400",children:e.jsx(xt,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(`/school/${n.schoolId}`),className:"p-2 bg-slate-100 dark:bg-slate-700 rounded-full text-slate-600",title:"Visit School Home",children:e.jsx(et,{className:"w-4 h-4"})}),C()]})]}),e.jsx("div",{className:"flex justify-between items-center mb-6 overflow-x-auto pb-2",children:e.jsx("div",{className:"flex bg-slate-200 dark:bg-slate-700 p-1 rounded-lg max-w-full",children:["students","subjects","marks","attendance","exams","assessments","reports","fees"].filter(a=>a!=="fees"||me).map(a=>e.jsx("button",{onClick:()=>u(a),className:`px-4 py-2 rounded-md text-sm font-bold capitalize whitespace-nowrap ${b===a?"bg-white dark:bg-slate-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:a},a))})}),e.jsxs("div",{className:"mt-4",children:[b==="students"&&e.jsx(ft,{user:n,students:r,pendingAdmissions:A,stats:s,sortingMethod:m==null?void 0:m.sortingMethod,onRefresh:Q,onDeleteStudent:we,onAdmissionAction:Ne,onCleanJunk:ve}),b==="subjects"&&e.jsx(wt,{subjects:f,onAddSubject:ke,onDeleteSubject:ee,canEdit:O}),b==="marks"&&e.jsx(jt,{students:r,marks:w,subjects:f,isSubmitted:k,loading:F,onMarkChange:ue,onSaveAll:q,onSubmitResults:je}),b==="attendance"&&e.jsx(vt,{students:r,classId:n.id}),b==="exams"&&e.jsx(gt,{classId:n.id}),b==="reports"&&e.jsx(Nt,{onPostNotice:le}),b==="assessments"&&e.jsx("div",{className:"text-center py-10 text-slate-400",children:"Assessments Module coming soon."}),b==="fees"&&e.jsx("div",{className:"text-center py-10 text-slate-400",children:"Fees Module coming soon."})]})]})};export{Ft as default};
