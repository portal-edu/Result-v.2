import{c as xe,r as t,a as N,j as e,G as Q,b as z,d as E,S as Ae,Z as Oe,C as De,F as $e,e as Be,T as ne,f as Ge,U as Me,g as be,h as Ee,i as Ye,k as Re,X as Pe,l as Ie,L as He,R as ze,M as Qe,m as Ve,B as _e,n as We,o as qe,u as Je,H as Xe,p as Ze}from"./index-CAgeZUTc.js";import{T as Te}from"./trash-2-C9uBVfXZ.js";import{P as Fe}from"./plus-DIeOG0JN.js";import{H as Ke,S as Le}from"./save-Dh3mLcKi.js";import{P as et}from"./printer-BGvYz7kd.js";import{P as tt}from"./pen-square-BUSkRSQX.js";import{C as st,a as at}from"./clipboard-check-B68S_YZu.js";import{U as lt,a as rt}from"./user-cog-CgdfkKIl.js";import{C as nt}from"./clock-x2Co9Mkc.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=xe("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=xe("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=xe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=xe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=xe("ScanSearch",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m16 16-1.9-1.9",key:"1dq9hf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=xe("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),ht=({imageSrc:r,onCrop:S,onCancel:u})=>{const x=t.useRef(null),l=t.useRef(null),[M,R]=t.useState(!1),[n,w]=t.useState(null),[b,F]=t.useState({x:0,y:0}),[d,g]=t.useState(!0),B=c=>{var i;const p=(i=l.current)==null?void 0:i.getBoundingClientRect();if(!p)return{x:0,y:0};const o=c.touches?c.touches[0].clientX:c.clientX,f=c.touches?c.touches[0].clientY:c.clientY;return{x:o-p.left,y:f-p.top}},y=c=>{const p=B(c);F(p),w({x:p.x,y:p.y,w:0,h:0}),R(!0)},Y=c=>{if(!M)return;const p=B(c);w({x:Math.min(b.x,p.x),y:Math.min(b.y,p.y),w:Math.abs(p.x-b.x),h:Math.abs(p.y-b.y)})},G=()=>R(!1);t.useEffect(()=>{r&&g(!0)},[r]);const v=()=>{if(l.current&&x.current){const c=x.current.naturalWidth/x.current.naturalHeight;let p=Math.min(window.innerWidth*.9,600),o=p/c;l.current.width=p,l.current.height=o,w(null);const f=l.current.getContext("2d");f&&(f.drawImage(x.current,0,0,p,o),f.fillStyle="rgba(0, 0, 0, 0.3)",f.fillRect(0,0,p,o)),setTimeout(()=>g(!1),600)}};t.useEffect(()=>{if(!l.current||!x.current||d)return;const c=l.current.getContext("2d");c&&(c.clearRect(0,0,l.current.width,l.current.height),c.drawImage(x.current,0,0,l.current.width,l.current.height),c.fillStyle="rgba(0, 0, 0, 0.5)",c.fillRect(0,0,l.current.width,l.current.height),n&&n.w>0?(c.clearRect(n.x,n.y,n.w,n.h),c.drawImage(x.current,0,0,x.current.width,x.current.height,0,0,l.current.width,l.current.height),c.fillStyle="rgba(0, 0, 0, 0.7)",c.fillRect(0,0,l.current.width,n.y),c.fillRect(0,n.y+n.h,l.current.width,l.current.height-(n.y+n.h)),c.fillRect(0,n.y,n.x,n.h),c.fillRect(n.x+n.w,n.y,l.current.width-(n.x+n.w),n.h),c.strokeStyle="#00ff00",c.lineWidth=2,c.setLineDash([6]),c.strokeRect(n.x,n.y,n.w,n.h)):(c.font="bold 14px sans-serif",c.fillStyle="white",c.textAlign="center",c.fillText("Drag to select text",l.current.width/2,l.current.height/2)))},[n,d]);const j=()=>{if(!n||!x.current||n.w<10){if(x.current&&l.current){x.current.naturalWidth/l.current.width,x.current.naturalHeight/l.current.height,w({x:0,y:0,w:l.current.width,h:l.current.height}),setTimeout(()=>j(),100);return}return}const c=l.current,p=x.current;if(!c)return;const o=p.naturalWidth/c.width,f=p.naturalHeight/c.height,i=document.createElement("canvas");i.width=n.w*o,i.height=n.h*f;const O=i.getContext("2d");O==null||O.drawImage(p,n.x*o,n.y*f,n.w*o,n.h*f,0,0,i.width,i.height),i.toBlob($=>{$&&S($)},"image/jpeg")};return e.jsxs("div",{className:"fixed inset-0 z-[70] bg-black/95 flex flex-col items-center justify-center p-4 backdrop-blur-sm",children:[d?e.jsxs("div",{className:"flex flex-col items-center animate-fade-in-up",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(xt,{className:"w-16 h-16 text-green-500 animate-pulse"}),e.jsx("div",{className:"absolute inset-0 bg-green-500/20 blur-xl rounded-full animate-ping"})]}),e.jsx("h3",{className:"text-white font-bold text-lg tracking-widest",children:"SCANNING PAGE..."}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Analyzing text structure"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-800 px-6 py-2 rounded-full mb-4 flex items-center gap-2 shadow-lg border border-slate-700 animate-fade-in-up",children:[e.jsx(ct,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-white text-sm font-bold",children:"Select the area to read"})]}),e.jsx("div",{className:"relative max-h-[70vh] overflow-hidden border-2 border-slate-700 rounded-lg bg-black shadow-2xl",children:e.jsx("canvas",{ref:l,onMouseDown:y,onMouseMove:Y,onMouseUp:G,onTouchStart:y,onTouchMove:Y,onTouchEnd:G,className:"cursor-crosshair block touch-none"})}),e.jsxs("div",{className:"flex gap-4 mt-6 w-full max-w-sm",children:[e.jsx(Q,{variant:"secondary",onClick:u,className:"flex-1 border-slate-600 text-slate-300 hover:bg-slate-800",children:"Discard"}),e.jsxs(Q,{onClick:j,className:"flex-1 bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-900/20",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"})," ",n&&n.w>10?"Crop Selection":"Use Full Page"]})]})]}),e.jsx("img",{ref:x,src:r,className:"hidden",onLoad:v})]})},ut=({classId:r})=>{const[S,u]=t.useState([]),[x,l]=t.useState(!1),[M,R]=t.useState(!1),[n,w]=t.useState(null),[b,F]=t.useState([]),[d,g]=t.useState(!1),[B,y]=t.useState(!1),[Y,G]=t.useState(!1),[v,j]=t.useState("SCAN"),[c,p]=t.useState(""),[o,f]=t.useState(5),[i,O]=t.useState("From Book Only"),[$,me]=t.useState("Malayalam"),[J,ee]=t.useState([]),[k,H]=t.useState(!1),[te,he]=t.useState(!1),[oe,V]=t.useState(null),[ue,ce]=t.useState(0),[fe,je]=t.useState([]),[Ne,we]=t.useState([]),[ve,ke]=t.useState(!1),[se,ae]=t.useState(""),[le,ye]=t.useState("CLASS_TEST"),[s,C]=t.useState(""),[A,a]=t.useState(""),[h,T]=t.useState(""),[D,I]=t.useState(30),[P,de]=t.useState({shuffleQuestions:!1,showResultImmediately:!0}),[L,_]=t.useState([{id:"1",text:"",options:["","","",""],correctOptionIndex:0,marks:1}]);t.useEffect(()=>{re()},[]);const ge=m=>{if(m.target.files&&m.target.files.length>0){const U=new FileReader;U.onload=W=>{var q;(q=W.target)!=null&&q.result&&(V(W.target.result),y(!1))},U.readAsDataURL(m.target.files[0])}},pe=async()=>{if(v==="TOPIC"&&!c)return alert("Please enter a topic.");if(v==="SCAN"&&J.length===0)return alert("Please upload at least one page.");if(!confirm("Generate Questions using AI? This will cost 5 Credits."))return;H(!0);const m=await N.deductCredits(5,"AI Question Generation");if(!m.success){H(!1),alert(`Wallet Low! Please ask Admin to Recharge Credits.

`+m.message);return}try{const U=new Be({apiKey:void 0}),W="gemini-2.5-flash",q=o+3,Z=[];let K=`Generate ${q} multiple choice questions. Language: ${$}. Provide JSON output with 'text', 'options' (array of 4 strings), 'correctOptionIndex' (0-3 number), and 'marks' (default 1).`;i==="From Book Only"?K+=" STRICT INSTRUCTION: Generate questions ONLY using the text content found in the provided images.":K+=` The questions should be appropriate for ${i} level students.`,v==="SCAN"?(J.forEach(Se=>{Z.push({inlineData:{mimeType:"image/jpeg",data:Se.split(",")[1]}})}),K+=" Analyze the images thoroughly. Focus on key facts."):K+=` The topic is: "${c}".`,Z.push({text:K});const Ue=await U.models.generateContent({model:W,contents:{parts:Z},config:{responseMimeType:"application/json",responseSchema:{type:ne.ARRAY,items:{type:ne.OBJECT,properties:{text:{type:ne.STRING},options:{type:ne.ARRAY,items:{type:ne.STRING}},correctOptionIndex:{type:ne.INTEGER},marks:{type:ne.INTEGER}}}}}}),Ce=JSON.parse(Ue.text||"[]");if(Array.isArray(Ce)&&Ce.length>0){const Se=Ce.map(ie=>({id:Math.random().toString(36).substr(2,9),text:ie.text,options:ie.options,correctOptionIndex:ie.correctOptionIndex,marks:ie.marks||1}));_(ie=>[...ie,...Se]),y(!1),ee([]),p(""),alert(`${Se.length} AI Questions Added!`)}else alert("AI could not generate valid questions.")}catch(U){U.message&&U.message.includes("429")?ce(60):alert("AI Generation failed. Please report.")}finally{H(!1)}},re=async()=>{const m=await N.getExamsForClass(r);u(m)},X=async()=>{if(!se||!A||!h)return alert("Please fill all details");R(!0);const m=await N.createExam({classId:r,title:se,examType:le,description:s,startTime:new Date(A).toISOString(),endTime:new Date(h).toISOString(),durationMinutes:D,questions:L,settings:P});R(!1),m.success?(l(!1),re(),ae(""),_([{id:"1",text:"",options:["","","",""],correctOptionIndex:0,marks:1}])):alert(m.message)};return x?e.jsxs("div",{className:"max-w-3xl mx-auto animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Create Exam"}),e.jsx(Q,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"})]}),e.jsxs(z,{className:"mb-6 border-t-4 border-t-blue-600",children:[e.jsx(E,{placeholder:"Exam Title",value:se,onChange:m=>ae(m.target.value)}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"Start Time"}),e.jsx(E,{type:"datetime-local",value:A,onChange:m=>a(m.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"End Time"}),e.jsx(E,{type:"datetime-local",value:h,onChange:m=>T(m.target.value)})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"Duration (Mins)"}),e.jsx(E,{type:"number",value:D,onChange:m=>I(parseInt(m.target.value))})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-slate-300",children:["Questions (",L.length,")"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>y(!0),className:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-xs font-bold shadow-lg flex items-center gap-2 hover:scale-105 transition-transform",children:[e.jsx(Ae,{className:"w-4 h-4 text-yellow-300"})," AI Generator ",e.jsx("span",{className:"bg-white/20 px-1 rounded text-[9px]",children:"5 Credits"})]})})]}),e.jsx("div",{className:"space-y-4 mb-6",children:L.map((m,U)=>e.jsxs(z,{className:"relative",children:[e.jsx("button",{onClick:()=>{const W=[...L];W.splice(U,1),_(W)},className:"absolute top-2 right-2 text-slate-300 hover:text-red-500",children:e.jsx(Te,{className:"w-4 h-4"})}),e.jsxs("label",{className:"text-xs font-bold text-slate-400 mb-1 block",children:["Question ",U+1]}),e.jsx(E,{className:"mb-3 font-bold",value:m.text,onChange:W=>{const q=[...L];q[U].text=W.target.value,_(q)},placeholder:"Question Text"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.options.map((W,q)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"radio",name:`q-${m.id}`,checked:m.correctOptionIndex===q,onChange:()=>{const Z=[...L];Z[U].correctOptionIndex=q,_(Z)},className:"w-4 h-4 accent-green-600 cursor-pointer"}),e.jsx(E,{className:"text-sm h-9",value:W,onChange:Z=>{const K=[...L];K[U].options[q]=Z.target.value,_(K)},placeholder:`Option ${q+1}`})]},q))})]},m.id))}),e.jsxs("div",{className:"flex gap-4 sticky bottom-4 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur p-2 rounded-2xl border shadow-xl",children:[e.jsx("button",{onClick:()=>_([...L,{id:Date.now().toString(),text:"",options:["","","",""],correctOptionIndex:0,marks:1}]),className:"flex-1 py-3 border-2 border-dashed rounded-xl font-bold text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:"Add Question"}),e.jsx(Q,{onClick:X,disabled:M,className:"flex-1 bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/30",children:M?"Saving...":"Save Exam"})]}),B&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4",children:e.jsxs(z,{className:"max-w-md w-full",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-500"})," AI Question Generator"]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border border-yellow-200 dark:border-yellow-800 mb-4 flex items-center gap-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-yellow-600 fill-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-yellow-800 dark:text-yellow-200",children:"Costs 5 Credits"}),e.jsx("p",{className:"text-[10px] text-yellow-700 dark:text-yellow-300",children:"Wallet balance is separate from student results."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>j("SCAN"),className:`flex-1 py-2 text-xs font-bold rounded transition-all ${v==="SCAN"?"bg-white dark:bg-slate-800 shadow text-blue-600":"text-slate-500"}`,children:"Scan Page"}),e.jsx("button",{onClick:()=>j("TOPIC"),className:`flex-1 py-2 text-xs font-bold rounded transition-all ${v==="TOPIC"?"bg-white dark:bg-slate-800 shadow text-blue-600":"text-slate-500"}`,children:"Topic"})]}),v==="TOPIC"&&e.jsx(E,{placeholder:"Enter Topic (e.g. Photosynthesis)",value:c,onChange:m=>p(m.target.value)}),v==="SCAN"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block p-4 border-2 border-dashed rounded-xl text-center cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors",children:[e.jsx(De,{className:"mx-auto h-8 w-8 text-slate-400 mb-2"}),e.jsx("span",{className:"text-xs text-slate-500 font-bold block",children:"Take Photo / Upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:ge})]}),J.length>0&&e.jsxs("p",{className:"text-center text-xs text-green-500 font-bold",children:[J.length," images scanned"]})]}),e.jsx(Q,{onClick:pe,disabled:k,className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-xl",children:k?"Analyzing & Generating...":"Generate (5 Credits)"}),e.jsx("button",{onClick:()=>y(!1),className:"w-full text-xs text-slate-500 mt-2 hover:text-slate-700",children:"Cancel"})]})]})}),oe&&e.jsx(ht,{imageSrc:oe,onCancel:()=>{V(null),y(!0)},onCrop:m=>{const U=new FileReader;U.readAsDataURL(m),U.onloadend=()=>{U.result&&(ee(W=>[...W,U.result]),V(null),y(!0))}}})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-xl dark:text-white",children:"Exams"}),e.jsxs(Q,{onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"})," New Exam"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[S.map(m=>e.jsxs(z,{className:"relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx($e,{className:"w-16 h-16"})}),e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-white",children:m.title}),e.jsxs("p",{className:"text-xs text-slate-500 mb-3",children:[m.questions.length," Questions â€¢ ",m.durationMinutes," Mins"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:"text-[10px] font-bold px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-500",children:new Date(m.startTime)>new Date?"Scheduled":new Date(m.endTime)<new Date?"Ended":"Live"})})]},m.id)),S.length===0&&e.jsx("div",{className:"col-span-full text-center py-10 text-slate-400",children:"No exams created yet."})]})]})},gt=({user:r,students:S,pendingAdmissions:u,stats:x,sortingMethod:l,onRefresh:M,onDeleteStudent:R,onAdmissionAction:n,onCleanJunk:w})=>{const[b,F]=t.useState(!1),[d,g]=t.useState({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),[B,y]=t.useState(!1),[Y,G]=t.useState({name:!1,dob:!1,gender:!1}),[v,j]=t.useState(""),[c,p]=t.useState(""),[o,f]=t.useState(!1),[i,O]=t.useState(!1),[$,me]=t.useState(null),[J,ee]=t.useState(!1),[k,H]=t.useState({}),[te,he]=t.useState(""),[oe,V]=t.useState([]),[ue,ce]=t.useState(!1);t.useEffect(()=>{(async()=>{const C=await N.getClasses();V(C.filter(A=>A.id!==r.id))})()},[r.id]);const fe=t.useMemo(()=>{const s=l||"BOYS_FIRST";if(s==="BOYS_FIRST"||s==="GIRLS_FIRST"){const C=S.filter(a=>a.gender==="Male").sort((a,h)=>(a.rollNo||9999)-(h.rollNo||9999)),A=S.filter(a=>a.gender!=="Male").sort((a,h)=>(a.rollNo||9999)-(h.rollNo||9999));return s==="BOYS_FIRST"?[...C,...A]:[...A,...C]}return[...S].sort((C,A)=>s==="ROLL_ONLY"?(C.rollNo||9999)-(A.rollNo||9999):s==="NAME_ONLY"?C.name.localeCompare(A.name):0)},[S,l]),je=s=>{d[s]?G(C=>({...C,[s]:!1})):G(C=>({...C,[s]:!0}))},Ne=async s=>{if(!s.target.files||s.target.files.length===0)return;if(!r.isPro){alert("Photo upload is an Elite/Pro feature.");return}O(!0);const C=s.target.files[0],A=await N.uploadImage(C,"students");O(!1),A.success&&A.publicUrl?(g(a=>({...a,photoUrl:A.publicUrl})),f(!1)):alert("Upload failed: "+A.message)},we=async s=>{s.preventDefault(),p(""),j(""),G({name:!1,dob:!1,gender:!1});let C=!1;if(d.name||(G(h=>({...h,name:!0})),C=!0),d.dob||(G(h=>({...h,dob:!0})),C=!0),d.gender||(G(h=>({...h,gender:!0})),C=!0),C){p("âš ï¸ Please fill Name, DOB & Gender!");return}y(!0);const A={...d,fatherName:d.fatherName||"Not Entered",motherName:d.motherName||"Not Entered",addedBy:r.teacherName||"Class Teacher"};if(!A.photoUrl){const h=A.name||"Felix";A.photoUrl=`https://api.dicebear.com/7.x/avataaars/svg?seed=${h}&gender=${A.gender==="Female"?"female":"male"}`}const a=await N.createStudent(r.id,A);y(!1),a.success?(j(`âœ… ${d.name} Added!`),g({regNo:"",rollNo:"",name:"",dob:"",gender:"",fatherName:"",motherName:"",photoUrl:""}),M(),setTimeout(()=>j(""),2500)):alert("Failed: "+a.message)},ve=s=>{me(s),H({...s}),ee(!1),he("")},ke=async()=>{await N.updateStudentDetails($.id,k),n($.id,"APPROVE"),ae(null)},se=async()=>{if(!te||!$)return;ce(!0);const s=await N.transferStudentAdmission($.id,te);ce(!1),s.success?(alert("Student Transferred Successfully!"),me(null),M()):alert("Transfer failed: "+s.message)},ae=s=>{me(s),ee(!1),H({})},le=`${window.location.origin}/#/register?schoolId=${r.schoolId}&classId=${r.id}`,ye=`Dear Parents,

Admission for *${r.name}* is now open.
Please register your child using the link below:

ðŸ”— ${le}

Thank you,
${r.teacherName||"Class Teacher"}`;return e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 animate-fade-in-up",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs(z,{className:"bg-gradient-to-br from-indigo-600 to-purple-700 text-white border-none relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:e.jsx(Me,{className:"w-24 h-24"})}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Smart Invite"}),e.jsx("p",{className:"text-xs text-indigo-200 mb-4",children:"Share this link with parents for self-registration."}),e.jsx("div",{className:"bg-black/20 p-2 rounded-lg text-[10px] font-mono mb-4 break-all truncate border border-white/10",children:le}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>window.open(`https://wa.me/?text=${encodeURIComponent(ye)}`,"_blank"),className:"flex-1 bg-[#25D366] hover:bg-[#20bd5a] text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1 shadow-lg",children:"WhatsApp"}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(le),className:"flex-1 bg-white/10 hover:bg-white/20 text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-1",children:"Copy Link"})]})]}),e.jsxs(z,{className:"bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsxs("h4",{className:"font-bold text-slate-700 dark:text-white flex items-center gap-2 text-sm mb-3",children:[e.jsx(Ke,{className:"w-4 h-4 text-orange-500"})," Class Health"]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-2",children:[e.jsx("span",{className:"text-slate-500",children:"Verified Students"}),e.jsx("span",{className:"font-bold text-green-600",children:x.total})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs mb-3",children:[e.jsx("span",{className:"text-slate-500",children:"Pending/Ghost"}),e.jsx("span",{className:"font-bold text-red-500",children:u.length})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mb-3",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${x.total/(x.total+u.length||1)*100}%`}})}),e.jsxs("button",{onClick:w,disabled:u.length===0,className:"w-full text-xs flex items-center justify-center gap-1 bg-white dark:bg-slate-800 border border-red-200 dark:border-red-900/50 text-red-600 dark:text-red-400 py-2 rounded hover:bg-red-50 dark:hover:bg-red-900/20 disabled:opacity-50",children:[e.jsx(mt,{className:"w-3 h-3"})," Delete All Unverified"]})]}),e.jsxs(z,{className:"border-t-4 border-t-blue-500 relative overflow-hidden",children:[v&&e.jsxs("div",{className:"absolute inset-0 z-20 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(be,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:v})]}),c&&e.jsx("div",{className:"mb-4 bg-red-50 text-red-600 p-2 rounded text-xs text-center border border-red-100",children:c}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(Ee,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Add Student"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Manual Entry"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-4 flex gap-4 items-center bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"relative w-16 h-16 shrink-0 rounded-full overflow-hidden border-2 border-slate-200 shadow-sm",children:d.photoUrl?e.jsx("img",{src:d.photoUrl,className:"w-full h-full object-cover"}):e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${d.name||"Felix"}&gender=${d.gender==="Female"?"female":"male"}`,className:"w-full h-full opacity-80"})}),e.jsx("div",{className:"flex-1 space-y-2",children:o?e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"cursor-pointer bg-slate-200 dark:bg-slate-700 px-3 py-1 rounded text-[10px] font-bold text-center block",children:[i?"Uploading...":"Choose File",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Ne,disabled:i})]}),e.jsx("button",{type:"button",onClick:()=>f(!1),className:"text-[10px] text-red-500",children:"Cancel"})]}):e.jsxs("div",{children:[e.jsx(E,{className:"text-xs h-8",placeholder:"Paste Image URL...",value:d.photoUrl,onChange:s=>g({...d,photoUrl:s.target.value})}),r.isPro&&e.jsx("button",{type:"button",onClick:()=>f(!0),className:"text-[10px] text-blue-600 font-bold underline mt-1 block",children:"Or Upload File"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"FULL NAME *"}),e.jsx("input",{value:d.name,onChange:s=>g({...d,name:s.target.value.toUpperCase()}),onBlur:()=>je("name"),className:`w-full bg-white dark:bg-slate-800 font-bold rounded-lg px-4 py-2.5 outline-none border-2 ${Y.name?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"Gender *"}),e.jsxs("select",{className:"w-full bg-white dark:bg-slate-800 px-3 py-2.5 outline-none font-medium border-2 rounded-lg",value:d.gender,onChange:s=>g({...d,gender:s.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Boy"}),e.jsx("option",{value:"Female",children:"Girl"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-slate-500 ml-1 font-bold uppercase",children:"DOB *"}),e.jsx("input",{type:"date",value:d.dob,onChange:s=>g({...d,dob:s.target.value}),className:`w-full bg-white dark:bg-slate-800 font-medium rounded-lg px-3 py-2 outline-none border-2 ${Y.dob?"border-red-500":"border-slate-300 dark:border-slate-600"}`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(E,{className:"text-sm font-mono",placeholder:"Reg No (Auto)",value:d.regNo,onChange:s=>g({...d,regNo:s.target.value})}),e.jsx(E,{type:"number",className:"text-sm font-mono",placeholder:"Roll No",value:d.rollNo,onChange:s=>g({...d,rollNo:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(E,{className:"text-sm",placeholder:"Father",value:d.fatherName,onChange:s=>g({...d,fatherName:s.target.value})}),e.jsx(E,{className:"text-sm",placeholder:"Mother",value:d.motherName,onChange:s=>g({...d,motherName:s.target.value})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Q,{onClick:we,disabled:B,className:"w-full py-3 text-sm font-bold",children:B?"Saving...":"Save & Add Next"})})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[u.length>0&&e.jsxs(z,{className:"bg-orange-50 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-orange-800 dark:text-orange-200 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"})," Pending Admissions (",u.length,")"]}),e.jsx("span",{className:"text-[10px] bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded",children:"Action Required"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:u.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 rounded-xl shadow-sm border border-slate-100 dark:border-slate-800 flex items-center justify-between group hover:border-orange-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.name}`,className:"w-10 h-10 rounded-full object-cover bg-slate-100"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm text-slate-800 dark:text-white",children:s.name}),e.jsxs("p",{className:"text-[10px] text-slate-500",children:["Applied: ",new Date().toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>ve(s),className:"bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-400 px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors",children:"Review"})]},s.id))})]}),e.jsxs(z,{className:"p-0 overflow-hidden min-h-[400px]",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-blue-500"})," Class List (",S.length,")"]}),e.jsxs(Q,{variant:"secondary",onClick:()=>F(!0),className:"text-xs flex items-center gap-1",children:[e.jsx(et,{className:"w-3 h-3"})," Register"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10",children:"Roll"}),e.jsx("th",{className:"p-3",children:"Name"}),e.jsx("th",{className:"p-3 w-24",children:"Reg No"}),e.jsx("th",{className:"p-3 w-24",children:"DOB"}),e.jsx("th",{className:"p-3 w-20 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:fe.map(s=>e.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-center text-slate-500",children:s.rollNo||"-"}),e.jsx("td",{className:"p-3 text-slate-800 dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold",children:[s.photoUrl&&e.jsx("img",{src:s.photoUrl,className:"w-6 h-6 rounded-full object-cover"}),s.name,s.isPremium&&e.jsx(Ye,{className:"w-3 h-3 text-yellow-500"})]})}),e.jsx("td",{className:"p-3 font-mono text-slate-600 dark:text-slate-300",children:s.regNo}),e.jsx("td",{className:"p-3 text-slate-500 font-mono",children:Re(s.dob)}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>R(s.id,s.name),className:"p-2 text-slate-400 hover:text-red-500",children:e.jsx(Te,{className:"w-4 h-4"})})})]},s.id))})]})})]})]}),$&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in-up",children:e.jsxs(z,{className:"w-full max-w-2xl bg-white dark:bg-slate-900 border-t-4 border-t-blue-600 max-h-[90vh] overflow-y-auto flex flex-col p-0",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-950",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Review Application"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Verify details before approving."})]}),e.jsx("button",{onClick:()=>ae(null),className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(Pe,{className:"w-5 h-5 text-slate-500"})})]}),e.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("img",{src:$.photoUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${$.name}`,className:"w-32 h-32 rounded-full object-cover mx-auto border-4 border-white dark:border-slate-800 shadow-lg bg-slate-100"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2",children:"Applicant Photo"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-900/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-bold text-blue-800 dark:text-blue-300 text-sm",children:"Student Details"}),e.jsxs("button",{onClick:()=>ee(!J),className:"text-xs text-blue-600 underline flex items-center gap-1",children:[e.jsx(tt,{className:"w-3 h-3"})," ",J?"Cancel Edit":"Edit"]})]}),e.jsx("div",{className:"space-y-2 text-sm",children:J?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-8 text-xs",value:k.name,onChange:s=>H({...k,name:s.target.value.toUpperCase()}),placeholder:"Name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(E,{className:"h-8 text-xs",value:k.regNo,onChange:s=>H({...k,regNo:s.target.value}),placeholder:"Reg No"}),e.jsx("input",{type:"date",className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:k.dob,onChange:s=>H({...k,dob:s.target.value})})]}),e.jsxs("select",{className:"h-8 text-xs bg-white dark:bg-slate-800 border rounded px-2 w-full",value:k.gender,onChange:s=>H({...k,gender:s.target.value}),children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Name:"})," ",e.jsx("span",{className:"font-bold",children:k.name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Reg No:"})," ",e.jsx("span",{className:"font-mono",children:k.regNo||"-"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"DOB:"})," ",e.jsx("span",{children:Re(k.dob)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-16 inline-block",children:"Gender:"})," ",e.jsx("span",{children:k.gender})]})]})})]})]}),e.jsxs("div",{className:"space-y-6 flex flex-col h-full",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-300 text-sm mb-3",children:"Parent Information"}),e.jsx("div",{className:"space-y-2 text-sm",children:J?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-8 text-xs",value:k.fatherName,onChange:s=>H({...k,fatherName:s.target.value}),placeholder:"Father's Name"}),e.jsx(E,{className:"h-8 text-xs",value:k.motherName,onChange:s=>H({...k,motherName:s.target.value}),placeholder:"Mother's Name"}),e.jsx(E,{className:"h-8 text-xs",value:k.phone,onChange:s=>H({...k,phone:s.target.value}),placeholder:"Phone"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Father:"})," ",e.jsx("span",{className:"font-bold",children:k.fatherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Mother:"})," ",e.jsx("span",{children:k.motherName})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Phone:"})," ",e.jsx("span",{children:k.phone})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500 w-20 inline-block",children:"Address:"})," ",e.jsx("span",{className:"text-xs",children:k.address||"-"})]})]})})]}),e.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Wrong Class? Transfer Request"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ie,{className:"h-9 text-xs py-0",value:te,onChange:s=>he(s.target.value),children:[e.jsx("option",{value:"",children:"Select Target Class"}),oe.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("button",{onClick:se,disabled:!te||ue,className:"bg-purple-100 text-purple-700 px-3 rounded-lg text-xs font-bold hover:bg-purple-200 transition-colors whitespace-nowrap",children:ue?"Moving...":e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-3 h-3 inline mr-1"})," Move"]})})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>n($.id,"REJECT"),className:"flex-1 py-3 border border-red-200 text-red-600 rounded-xl font-bold text-sm hover:bg-red-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4"})," Reject"]}),e.jsxs("button",{onClick:ke,className:"flex-[2] py-3 bg-green-600 text-white rounded-xl font-bold text-sm hover:bg-green-700 shadow-lg shadow-green-500/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx(be,{className:"w-4 h-4"})," Approve Admission"]})]})]})]})]})]})})]})},pt=({students:r,marks:S,subjects:u,isSubmitted:x,loading:l,onMarkChange:M,onSaveAll:R,onSubmitResults:n})=>{const w=[...r].sort((v,j)=>(v.rollNo||9999)-(j.rollNo||9999)),[b,F]=t.useState("TERM"),[d,g]=t.useState(!1),[B,y]=t.useState(!1);t.useEffect(()=>{(async()=>{const j=await N.getSchoolConfig();j!=null&&j.allowTeacherDirectPublish&&g(!0)})()},[]);const Y=["CLASS_TEST","REVISION"].includes(b),G=async()=>{if(Y&&d){if(!confirm(`Directly publish ${b} results? Parents will see this immediately.`))return;y(!0),n()}else n()};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase block mb-1",children:"Assessment Type"}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>F("TERM"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${b==="TERM"?"bg-white dark:bg-slate-800 text-blue-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(st,{className:"w-4 h-4"})," Term Exam"]}),e.jsxs("button",{onClick:()=>F("CLASS_TEST"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${b==="CLASS_TEST"?"bg-white dark:bg-slate-800 text-purple-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(at,{className:"w-4 h-4"})," Class Test"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white hidden md:block",children:"Marks Entry"}),x&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded font-bold flex items-center gap-1",children:[e.jsx(He,{className:"w-3 h-3"})," Locked"]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs(Q,{onClick:R,variant:"secondary",disabled:l||x,className:"flex-1 md:flex-none",children:[e.jsx(Le,{className:"w-4 h-4 mr-2 inline"})," Save Draft"]}),Y&&d?e.jsxs(Q,{onClick:G,className:"bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg shadow-emerald-500/20 flex-1 md:flex-none",disabled:x,children:[e.jsx(ze,{className:"w-4 h-4 mr-2 inline"})," Publish Result"]}):e.jsx(Q,{onClick:n,className:x?"bg-orange-500 hover:bg-orange-600 flex-1 md:flex-none":"bg-blue-600 hover:bg-blue-700 flex-1 md:flex-none",children:x?e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2 inline"})," Request Unlock"]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4 mr-2 inline"})," Submit to Admin"]})})]})]}),e.jsx(z,{className:"overflow-x-auto p-0",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 dark:bg-slate-800 text-xs uppercase font-bold text-slate-500 dark:text-slate-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-3 w-48 sticky left-0 bg-slate-100 dark:bg-slate-800 z-10",children:"Student Name"}),u.map(v=>e.jsxs("th",{className:"p-3 text-center min-w-[80px]",children:[v.name.substring(0,10),e.jsxs("span",{className:"block text-[9px] opacity-60",children:["Max: ",v.maxMarks]})]},v.name)),e.jsx("th",{className:"p-3 w-24 text-center font-black",children:"Total"}),e.jsx("th",{className:"p-3 w-16 text-center",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:w.map(v=>{const j=S[v.id];return j?e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3 text-center font-mono text-slate-500",children:v.rollNo||"-"}),e.jsx("td",{className:"p-3 font-bold text-slate-700 dark:text-slate-200 sticky left-0 bg-white dark:bg-slate-900 z-10 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:v.name}),u.map(c=>e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"text",className:`w-12 text-center p-1.5 rounded border outline-none font-bold transition-all focus:ring-2 focus:ring-blue-500 ${x?"bg-slate-100 text-slate-500 cursor-not-allowed":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700"}`,value:j.subjects[c.name]||"",onChange:p=>M(v.id,c.name,p.target.value),disabled:x,placeholder:"-"})},c.name)),e.jsx("td",{className:"p-3 text-center font-black text-blue-600 dark:text-blue-400",children:j.total}),e.jsx("td",{className:`p-3 text-center font-bold ${j.grade==="F"?"text-red-500":"text-green-600"}`,children:j.grade})]},v.id):null})})]})})]})},bt=({onPostNotice:r})=>{const[S,u]=t.useState(""),[x,l]=t.useState(""),[M,R]=t.useState(""),[n,w]=t.useState(!1),[b,F]=t.useState(!1);t.useEffect(()=>{if(n){const g=setTimeout(()=>w(!1),2e3);return()=>clearTimeout(g)}},[n]);const d=async()=>{if(!S||!x){alert("Please enter title and message");return}F(!0);const g=await r(S,x,M);F(!1),g&&(u(""),l(""),R(""),w(!0))};return e.jsx("div",{className:"max-w-md mx-auto animate-fade-in-up",children:e.jsxs(z,{className:"border-t-4 border-t-blue-500 relative overflow-hidden",children:[n&&e.jsxs("div",{className:"absolute inset-0 z-10 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center text-center animate-fade-in-up",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4 animate-bounce",children:e.jsx(be,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-white",children:M?"Scheduled!":"Notice Posted!"})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(Qe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:"Post Notice"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Inform students & parents"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Title"}),e.jsx(E,{placeholder:"e.g. Exam Schedule",value:S,onChange:g=>u(g.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Message"}),e.jsx("textarea",{className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-3 text-sm h-32 resize-none",placeholder:"Type here...",value:x,onChange:g=>l(g.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Schedule for Later (Optional)"}),e.jsx(E,{type:"datetime-local",value:M,onChange:g=>R(g.target.value)})]}),e.jsxs(Q,{onClick:d,disabled:b,className:"w-full flex items-center justify-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),b?"Posting...":M?"Schedule Post":"Post Notice"]})]})]})})},ft=({subjects:r,onAddSubject:S,onDeleteSubject:u,canEdit:x})=>{const[l,M]=t.useState({name:"",max:"50",pass:"18"}),[R,n]=t.useState(!1),w=async()=>{if(!l.name)return;n(!0);const b=parseInt(l.max)||50,F=parseInt(l.pass)||18,d=await S(l.name,b,F);n(!1),d&&M({name:"",max:"50",pass:"18"})};return e.jsx("div",{className:"max-w-2xl mx-auto animate-fade-in-up",children:e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-2 rounded-lg text-purple-600 dark:text-purple-400",children:e.jsx(_e,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white",children:"Manage Subjects"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Add or remove subjects for this class."})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[r.map((b,F)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200",children:b.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Max: ",b.maxMarks," | Pass: ",b.passMarks]})]}),x&&e.jsx("button",{onClick:()=>u(F),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(Te,{className:"w-4 h-4"})})]},F)),r.length===0&&e.jsx("p",{className:"text-center text-slate-400 text-sm",children:"No subjects added."})]}),x?e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-900 p-4 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 mb-3 uppercase",children:"Add New Subject"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(E,{placeholder:"Subject Name (e.g. Maths)",value:l.name,onChange:b=>M({...l,name:b.target.value}),className:"flex-[2]"}),e.jsx("div",{className:"flex-1",children:e.jsx(E,{type:"number",placeholder:"Max",value:l.max,onChange:b=>M({...l,max:b.target.value})})}),e.jsx("div",{className:"flex-1",children:e.jsx(E,{type:"number",placeholder:"Pass",value:l.pass,onChange:b=>M({...l,pass:b.target.value})})})]}),e.jsx(Q,{onClick:w,disabled:R,className:"w-full flex justify-center items-center gap-2",children:R?"Adding...":e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-4 h-4"})," Add Subject"]})})]}):e.jsx("div",{className:"text-center p-4 bg-yellow-50 text-yellow-700 text-sm rounded-lg border border-yellow-200",children:"Subject editing is disabled by Admin."})]})})},jt=({students:r,classId:S})=>{const[u,x]=t.useState("DAILY"),[l,M]=t.useState(new Date().toISOString().split("T")[0]),[R,n]=t.useState("Term 1"),[w,b]=t.useState({}),[F,d]=t.useState(!1),[g,B]=t.useState(!1),[y,Y]=t.useState(50);t.useEffect(()=>{G()},[u,l,R]);const G=async()=>{d(!0);const o={};u==="DAILY"?((await N.getAttendanceByDate(S,l)).forEach(i=>{o[i.studentId]=i.status}),r.forEach(i=>{o[i.id]||(o[i.id]="PRESENT")})):((await N.getAttendanceByTerm(S,R)).forEach(i=>{o[i.studentId]={present:i.presentDays,total:i.workingDays},i.workingDays&&Y(i.workingDays)}),r.forEach(i=>{o[i.id]||(o[i.id]={present:0,total:y})})),b(o),d(!1)},v=o=>{b(f=>{const i=f[o],O=i==="PRESENT"?"ABSENT":i==="ABSENT"?"LATE":"PRESENT";return{...f,[o]:O}})},j=(o,f)=>{const i=parseInt(f)||0;b(O=>({...O,[o]:{present:i,total:y}}))},c=async()=>{B(!0);const o=r.map(i=>({studentId:i.id,classId:S,date:l,status:w[i.id],type:"DAILY"})),f=await N.markDailyAttendance(o);B(!1),f.success?alert("Daily Attendance Saved!"):alert("Failed to save.")},p=async()=>{B(!0);const o=r.map(i=>{var O;return{studentId:i.id,classId:S,term:R,workingDays:y,presentDays:((O=w[i.id])==null?void 0:O.present)||0,status:"PRESENT",type:"SUMMARY"}}),f=await N.saveSummaryAttendance(o);B(!1),f.success?alert("Term Attendance Saved!"):alert("Failed to save.")};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 gap-4",children:[e.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-900 p-1 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>x("DAILY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${u==="DAILY"?"bg-white dark:bg-slate-800 shadow text-blue-600 dark:text-blue-400":"text-slate-500"}`,children:[e.jsx(We,{className:"w-4 h-4"})," Daily Tracker"]}),e.jsxs("button",{onClick:()=>x("SUMMARY"),className:`px-4 py-2 rounded-md text-xs font-bold flex items-center gap-2 transition-all ${u==="SUMMARY"?"bg-white dark:bg-slate-800 shadow text-purple-600 dark:text-purple-400":"text-slate-500"}`,children:[e.jsx(dt,{className:"w-4 h-4"})," Term Summary"]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[u==="DAILY"?e.jsx(E,{type:"date",value:l,onChange:o=>M(o.target.value),className:"font-bold text-sm"}):e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{value:R,onChange:o=>n(o.target.value),className:"w-32 text-sm py-2",children:[e.jsx("option",{children:"Term 1"}),e.jsx("option",{children:"Term 2"}),e.jsx("option",{children:"Finals"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-900 px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsx("span",{className:"text-[10px] text-slate-500 font-bold uppercase whitespace-nowrap",children:"Total Days:"}),e.jsx("input",{type:"number",className:"w-12 bg-transparent text-sm font-bold text-center outline-none",value:y,onChange:o=>Y(parseInt(o.target.value)||0)})]})]}),e.jsx(Q,{onClick:u==="DAILY"?c:p,disabled:g,className:"bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/20",children:g?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"w-4 h-4 mr-2"})," Save"]})})]})]}),e.jsx(z,{className:"p-0 overflow-hidden min-h-[400px]",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 w-16 text-center",children:"Roll"}),e.jsx("th",{className:"p-4",children:"Student Name"}),e.jsx("th",{className:"p-4 text-center",children:"Status / Days Present"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:r.map(o=>{var f,i,O;return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-4 text-center text-slate-500 font-mono",children:o.rollNo||"-"}),e.jsx("td",{className:"p-4 font-bold text-slate-700 dark:text-slate-200",children:o.name}),e.jsx("td",{className:"p-4 text-center",children:F?e.jsx("div",{className:"h-8 w-24 bg-slate-100 dark:bg-slate-800 rounded animate-pulse mx-auto"}):u==="DAILY"?e.jsxs("button",{onClick:()=>v(o.id),className:`w-32 py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all ${w[o.id]==="PRESENT"?"bg-green-100 text-green-700 border border-green-200":w[o.id]==="ABSENT"?"bg-red-100 text-red-700 border border-red-200":"bg-yellow-100 text-yellow-700 border border-yellow-200"}`,children:[w[o.id]==="PRESENT"&&e.jsx(be,{className:"w-4 h-4"}),w[o.id]==="ABSENT"&&e.jsx(qe,{className:"w-4 h-4"}),w[o.id]==="LATE"&&e.jsx(nt,{className:"w-4 h-4"}),w[o.id]||"PRESENT"]}):e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"number",className:"w-16 p-2 text-center font-bold bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none",value:((f=w[o.id])==null?void 0:f.present)||0,onChange:$=>j(o.id,$.target.value)})}),e.jsxs("span",{className:"text-slate-400 text-xs",children:["/ ",y]}),e.jsxs("span",{className:`text-xs font-bold ml-2 ${((i=w[o.id])==null?void 0:i.present)/y<.75?"text-red-500":"text-green-500"}`,children:[y>0?Math.round(((O=w[o.id])==null?void 0:O.present)/y*100):0,"%"]})]})})]},o.id)})})]})})]})},Mt=({user:r})=>{const S=Je(),[u,x]=t.useState("students"),[l,M]=t.useState([]),[R,n]=t.useState([]),[w,b]=t.useState({}),[F,d]=t.useState(!1),[g,B]=t.useState(r.subjects),[y,Y]=t.useState(r.submissionStatus==="SUBMITTED"),[G,v]=t.useState(!1),[j,c]=t.useState({name:r.teacherName||"",photo:r.teacherPhoto||""}),[p,o]=t.useState(!1),[f,i]=t.useState(null),[O,$]=t.useState(!1),[me,J]=t.useState(""),[ee,k]=t.useState([]),[H,te]=t.useState([]),[he,oe]=t.useState(!1);t.useEffect(()=>{V(),ue()},[]);const V=async()=>{d(!0);const a=await N.getSchoolConfig();i(a),v((a==null?void 0:a.allowTeacherSubjectEdit)??!1);const h=(a==null?void 0:a.feeManagerRole)||"ADMIN",D=(await N.getFeeStructures(r.id)).filter(L=>L.collectedBy==="TEACHER"||L.collectedBy==="BOTH"||h==="TEACHER"||h==="HYBRID");te(D),oe(D.length>0);const I=await N.getStudentsByClass(r.id);M(I);const P={};for(const L of I){const _=await N.getMarks(L.id,"Term 1");_?P[L.id]=_:P[L.id]={studentId:L.id,subjects:g.reduce((ge,pe)=>({...ge,[pe.name]:0}),{}),total:0,grade:"F",term:"Term 1"}}b(P);const de=await N.getPendingAdmissions(r.id);n(de),de.length>0&&((a==null?void 0:a.admissionApprover)==="TEACHER"||(a==null?void 0:a.admissionApprover)==="BOTH"||!(a!=null&&a.admissionApprover))&&x("students"),d(!1)},ue=async()=>{const a=await N.getAssessmentPrograms("TEACHER",r.id);k(a)},ce=(a,h,T)=>{if(y)return;let D="";if(T!==""){const I=T.toUpperCase(),P=parseInt(T);if(isNaN(P)&&I!=="A"&&I!=="AB")return;I==="A"||I==="AB"?D=I:D=P}b(I=>{const P={...I[a]};P.subjects={...P.subjects,[h]:D};const de=Object.values(P.subjects).reduce((re,X)=>re+(typeof X=="number"?X:0),0);P.total=de;let L=0,_=!1;Object.keys(P.subjects).forEach(re=>{const X=g.find(m=>m.name===re);if(X){L+=X.maxMarks;const m=P.subjects[re];(typeof m=="number"?m:0)<X.passMarks&&(_=!0)}});const{grade:ge,resultStatus:pe}=Ze(de,L,_);return P.grade=ge,P.resultStatus=pe,{...I,[a]:P}})},fe=async()=>{d(!0);for(const a of Object.values(w))await N.saveMarks(a);d(!1),alert("All marks saved successfully!")},je=async()=>{if(y){const h=prompt("Request Admin to unlock this class? (Optional: Enter reason)");h!==null&&((await N.createSystemFeedback(`Unlock Request for Class ${r.name}. Reason: ${h}`,"SUPPORT",r.teacherName||"Teacher")).success?alert("Unlock Request Sent to Admin!"):alert("Failed to send request."));return}if(!window.confirm("Verify & Submit to Admin?"))return;(await N.toggleClassSubmission(r.id,!0)).success&&(Y(!0),alert("Submitted Successfully!"))},Ne=async(a,h)=>{if(h==="APPROVE"){const T=await N.verifyStudent(a,r.teacherName||"Teacher");T.success?(V(),n(D=>D.filter(I=>I.id!==a))):alert(T.message)}else{if(!window.confirm("Reject this admission?"))return;(await N.rejectAdmission(a)).success&&n(D=>D.filter(I=>I.id!==a))}},we=async(a,h)=>{if(!window.confirm(`Delete ${h}?`))return;const T=await N.deleteStudent(a);T.success?V():alert("Failed: "+T.message)},ve=async()=>{if(!window.confirm("Warning: This will delete all Unverified (Ghost) students in your class. Continue?"))return;(await N.deleteUnverifiedStudents(r.id)).success?(alert("Cleaned successfully!"),V()):alert("Failed to clean.")},ke=async(a,h,T)=>{const D=[...g,{name:a,maxMarks:h,passMarks:T}];return(await N.updateClassSubjects(r.id,D)).success?(B(D),V(),!0):(alert("Failed to add subject"),!1)},se=async a=>{if(!window.confirm("Delete this subject? Existing marks will be hidden."))return;const h=[...g];h.splice(a,1),(await N.updateClassSubjects(r.id,h)).success&&(B(h),V())},ae=async(a,h,T)=>{const D=r.teacherName||r.name||"Teacher",I=T?new Date(T).toISOString():void 0,P=await N.createCampusPost(r.schoolId||"",D,h,"TEACHER","NOTICE",a,I);return P.success?!0:(alert("Failed: "+P.message),!1)},le=async()=>{(await N.updateClassDetails(r.id,{teacherName:j.name,teacherPhoto:j.photo})).success?o(!1):alert("Failed update")},ye=async a=>{if(!a.target.files||a.target.files.length===0)return;if(!r.isPro){alert("Photo upload is an Elite/Pro feature.");return}const h=a.target.files[0],T=await N.uploadImage(h,"teachers");T.success&&T.publicUrl?c(D=>({...D,photo:T.publicUrl})):alert("Upload failed: "+T.message)},C={total:l.length,male:l.filter(a=>a.gender==="Male").length,female:l.filter(a=>a.gender==="Female").length},A=()=>{if(u==="students")return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:[C.male," B"]})}),e.jsx("div",{className:"flex items-center gap-1 bg-pink-50 dark:bg-pink-900/40 px-2 py-1 rounded",children:e.jsxs("span",{className:"text-xs font-bold text-pink-700 dark:text-pink-300",children:[C.female," G"]})})]});if(u==="marks"){const a=Object.values(w).filter(h=>h.total>0).length;return e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded text-xs",children:[e.jsx("span",{className:"text-slate-500 font-bold uppercase",children:"Progress:"}),e.jsxs("span",{className:`font-bold ${a===C.total?"text-green-600":"text-slate-800"}`,children:[a," / ",C.total]})]})}return null};return e.jsxs("div",{className:"pb-20 relative animate-fade-in-up",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 p-3 mb-4 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsxs("div",{className:"relative group shrink-0",children:[j.photo?e.jsx("img",{src:j.photo,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900 rounded-lg flex items-center justify-center text-blue-600 dark:text-blue-300",children:e.jsx(rt,{className:"w-6 h-6"})}),p&&e.jsxs("label",{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center cursor-pointer",children:[e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:ye}),e.jsx(De,{className:"w-4 h-4 text-white"})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-black text-blue-600 dark:text-blue-400",children:r.name}),p?e.jsxs("div",{className:"space-y-1",children:[e.jsx("input",{className:"bg-slate-50 border rounded px-1 text-xs",value:j.name,onChange:a=>c({...j,name:a.target.value})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:le,className:"text-[10px] bg-green-100 text-green-700 px-2 rounded",children:"Save"}),e.jsx("button",{onClick:()=>$(!0),className:"text-[10px] bg-yellow-100 text-yellow-700 px-2 rounded",children:"Pass"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:j.name||"Class Teacher"}),e.jsx("button",{onClick:()=>o(!0),className:"text-slate-400",children:e.jsx(it,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(`/school/${r.schoolId}`),className:"p-2 bg-slate-100 dark:bg-slate-700 rounded-full text-slate-600",title:"Visit School Home",children:e.jsx(Xe,{className:"w-4 h-4"})}),A()]})]}),e.jsx("div",{className:"flex justify-between items-center mb-6 overflow-x-auto pb-2",children:e.jsx("div",{className:"flex bg-slate-200 dark:bg-slate-700 p-1 rounded-lg max-w-full",children:["students","subjects","marks","attendance","exams","assessments","reports","fees"].filter(a=>a!=="fees"||he).map(a=>e.jsx("button",{onClick:()=>x(a),className:`px-4 py-2 rounded-md text-sm font-bold capitalize whitespace-nowrap ${u===a?"bg-white dark:bg-slate-800 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-300"}`,children:a},a))})}),u==="students"&&e.jsx(gt,{user:r,students:l,pendingAdmissions:R,stats:C,sortingMethod:f==null?void 0:f.sortingMethod,onRefresh:V,onDeleteStudent:we,onAdmissionAction:Ne,onCleanJunk:ve}),u==="marks"&&e.jsx(pt,{students:l,marks:w,subjects:g,isSubmitted:y,loading:F,onMarkChange:ce,onSaveAll:fe,onSubmitResults:je}),u==="reports"&&e.jsx(bt,{onPostNotice:ae}),u==="subjects"&&e.jsx(ft,{subjects:g,onAddSubject:ke,onDeleteSubject:se,canEdit:G}),u==="exams"&&e.jsx(ut,{classId:r.id}),u==="attendance"&&e.jsx(jt,{students:l,classId:r.id}),u==="assessments"&&e.jsx("div",{className:"p-4 text-center",children:"Assessments Module"}),u==="fees"&&e.jsx("div",{className:"p-4 text-center",children:"Fees Module"})]})};export{Mt as default};
