import{r as d,b as m,j as e,N as D,n as G,t as E,O as F,Q as M,G as O,V as P,f as g}from"./index-E6X91Rqg.js";const B=()=>{const[f,c]=d.useState(!1),[i,b]=d.useState([]),[p,j]=d.useState([]),[w,v]=d.useState("ALL"),[t,C]=d.useState({rollNo:!0,regNo:!0,name:!0,gender:!0,dob:!0,fatherName:!0,motherName:!1,className:!0,status:!0}),[u,S]=d.useState(!1);d.useEffect(()=>{k()},[]);const k=async()=>{c(!0);const s=await m.getClasses();j(s),await N("ALL"),c(!1)},N=async s=>{var x;let a=[];if(s==="ALL"){const o=await m.getClasses();for(const l of o){const n=(await m.getStudentsByClass(l.id)).map(h=>({...h,className:l.name}));a=[...a,...n]}}else{const o=await m.getStudentsByClass(s),l=((x=p.find(r=>r.id===s))==null?void 0:x.name)||"";a=o.map(r=>({...r,className:l}))}a.sort((o,l)=>o.className!==l.className?(o.className||"").localeCompare(l.className||""):(o.rollNo||0)-(l.rollNo||0)),b(a)},y=async s=>{const a=s.target.value;v(a),c(!0),await N(a),c(!1)},L=s=>{C(a=>({...a,[s]:!a[s]}))},R=()=>{const s=[];t.rollNo&&s.push("Roll No"),t.regNo&&s.push("Reg No"),t.name&&s.push("Name"),t.gender&&s.push("Gender"),t.dob&&s.push("DOB"),t.fatherName&&s.push("Father"),t.motherName&&s.push("Mother"),t.className&&s.push("Class"),t.status&&s.push("Status");const a=i.map(r=>{const n=[];return t.rollNo&&n.push(r.rollNo||""),t.regNo&&n.push(r.regNo),t.name&&n.push(r.name),t.gender&&n.push(r.gender),t.dob&&n.push(g(r.dob)),t.fatherName&&n.push(r.fatherName),t.motherName&&n.push(r.motherName),t.className&&n.push(r.className),t.status&&n.push(r.isVerified?"Active":"Pending"),n.map(h=>`"${h}"`).join(",")}),x="data:text/csv;charset=utf-8,"+[s.join(","),...a].join(`
`),o=encodeURI(x),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download",`School_Register_${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},A=()=>{window.print()};return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm print:hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"font-bold text-lg text-slate-800 dark:text-white",children:"Master Register"})]}),e.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-600"}),e.jsxs(G,{value:w,onChange:y,className:"w-40 py-1.5 text-sm",children:[e.jsx("option",{value:"ALL",children:"All Classes"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!u),className:"flex items-center gap-2 px-3 py-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-300 hover:bg-slate-200 transition-colors",children:[e.jsx(E,{className:"w-4 h-4"})," Columns"]}),u&&e.jsxs("div",{className:"absolute top-10 right-0 w-48 bg-white dark:bg-slate-800 shadow-xl rounded-xl border border-slate-200 dark:border-slate-700 p-2 z-50",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-slate-400 mb-2 px-2",children:"Toggle Fields"}),Object.keys(t).map(s=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-slate-50 dark:hover:bg-slate-700 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t[s],onChange:()=>L(s),className:"accent-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300 capitalize",children:s.replace(/([A-Z])/g," $1").trim()})]},s))]})]}),e.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-3 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg text-xs font-bold hover:bg-green-100 transition-colors",children:[e.jsx(F,{className:"w-4 h-4"})," Export CSV"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-3 py-2 bg-slate-800 text-white rounded-lg text-xs font-bold hover:bg-slate-900 transition-colors",children:[e.jsx(M,{className:"w-4 h-4"})," Print"]})]})]}),e.jsx(O,{className:"p-0 overflow-hidden min-h-[500px]",children:f?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx(P,{}),e.jsx("div",{className:"mt-4 text-slate-500 text-sm",children:"Loading Register..."})]}):e.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-left text-sm border-collapse whitespace-nowrap",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 dark:text-slate-400 font-bold uppercase text-[10px] tracking-wider border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10 text-center",children:"#"}),t.rollNo&&e.jsx("th",{className:"p-3",children:"Roll"}),t.regNo&&e.jsx("th",{className:"p-3",children:"Reg No"}),t.name&&e.jsx("th",{className:"p-3",children:"Student Name"}),t.gender&&e.jsx("th",{className:"p-3",children:"Gender"}),t.dob&&e.jsx("th",{className:"p-3",children:"DOB"}),t.className&&e.jsx("th",{className:"p-3",children:"Class"}),t.fatherName&&e.jsx("th",{className:"p-3",children:"Father"}),t.motherName&&e.jsx("th",{className:"p-3",children:"Mother"}),t.status&&e.jsx("th",{className:"p-3 text-center",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[i.map((s,a)=>e.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-center text-slate-400 text-xs",children:a+1}),t.rollNo&&e.jsx("td",{className:"p-3 font-mono text-slate-600 dark:text-slate-400",children:s.rollNo||"-"}),t.regNo&&e.jsx("td",{className:"p-3 font-mono font-bold text-slate-700 dark:text-slate-300",children:s.regNo}),t.name&&e.jsx("td",{className:"p-3 font-bold text-slate-800 dark:text-white uppercase",children:s.name}),t.gender&&e.jsx("td",{className:"p-3 text-xs",children:s.gender}),t.dob&&e.jsx("td",{className:"p-3 text-xs font-mono",children:g(s.dob)}),t.className&&e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase",children:s.className})}),t.fatherName&&e.jsx("td",{className:"p-3 text-xs text-slate-500",children:s.fatherName}),t.motherName&&e.jsx("td",{className:"p-3 text-xs text-slate-500",children:s.motherName}),t.status&&e.jsx("td",{className:"p-3 text-center",children:s.isVerified?e.jsx("span",{className:"text-[10px] text-green-600 bg-green-50 px-2 py-0.5 rounded-full font-bold",children:"Active"}):e.jsx("span",{className:"text-[10px] text-orange-600 bg-orange-50 px-2 py-0.5 rounded-full font-bold",children:"Pending"})})]},s.id)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"p-8 text-center text-slate-400 italic",children:"No records found."})})]})]})})}),e.jsxs("div",{className:"text-center text-[10px] text-slate-400 print:hidden",children:["Showing ",i.length," Records â€¢ Generated on ",new Date().toLocaleDateString()]})]})};export{B as default};
