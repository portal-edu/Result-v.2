import{c as m,r as u,j as e,h as c,l as K,G as N,m as D,d as p,n as S,T as E,P as I,o as W,p as G,q as U,s as J,b as y}from"./index-E6X91Rqg.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=m("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=m("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=m("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=m("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=m("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=m("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),ae=({assessments:v,classes:i,onRefresh:k})=>{const[q,o]=u.useState(!1),[C,w]=u.useState(!1),[P,j]=u.useState(!1),[h,b]=u.useState(null),[l,d]=u.useState({name:"",type:"STAR",frequency:"WEEKLY",assignee:"TEACHER",targetClassIds:[],questions:[{id:"q1",text:"Homework",maxVal:5}],sessionCount:1,schedules:[{name:"Term 1",startDate:new Date().toISOString().split("T")[0],endDate:"",startTime:"09:00",endTime:"16:00"}]}),M=s=>{d(t=>{const a=t.targetClassIds.includes(s);let r;return a?r=t.targetClassIds.filter(n=>n!==s):r=[...t.targetClassIds,s],{...t,targetClassIds:r}})},R=()=>{d(s=>s.targetClassIds.length===i.length?{...s,targetClassIds:[]}:{...s,targetClassIds:i.map(t=>t.id)})},H=()=>{d(s=>({...s,questions:[...s.questions,{id:`q${Date.now()}`,text:"",maxVal:s.type==="STAR"?5:s.type==="EMOJI"?3:10,assignee:"TEACHER"}]}))},f=(s,t,a)=>{const r=[...l.questions];r[s]={...r[s],[t]:a},d(n=>({...n,questions:r}))},O=s=>{const t=[...l.questions];t.splice(s,1),d(a=>({...a,questions:t}))},A=(s,t,a)=>{d(r=>{const n=[...r.schedules];return n[s]={...n[s],[t]:a},{...r,schedules:n}})},L=()=>{if(!l.name)return alert("Please enter a program name");if(l.questions.some(t=>!t.text))return alert("Please fill all questions");if(l.schedules.some(t=>!t.startDate||!t.endDate))return alert("Please fill start and end dates for all sessions.");j(!0)},Y=async()=>{var a,r;w(!0);const s={...l,targetClassIds:l.targetClassIds.length===0?i.map(n=>n.id):l.targetClassIds,startDate:(a=l.schedules[0])==null?void 0:a.startDate,endDate:(r=l.schedules[l.schedules.length-1])==null?void 0:r.endDate};let t;h?t=await y.updateAssessmentProgram(h,s):t=await y.createAssessmentProgram(s),w(!1),j(!1),t.success?(o(!1),b(null),k(),d({name:"",type:"STAR",frequency:"WEEKLY",assignee:"TEACHER",targetClassIds:[],questions:[{id:"q1",text:"Homework",maxVal:5}],sessionCount:1,schedules:[{name:"Term 1",startDate:new Date().toISOString().split("T")[0],endDate:"",startTime:"09:00",endTime:"16:00"}]})):alert("Failed: "+(typeof t.message=="string"?t.message:JSON.stringify(t.message)))},$=s=>{var t,a;b(s.id),d({name:s.name,type:s.type,frequency:s.frequency,assignee:s.assignee,targetClassIds:s.targetClassIds||[],questions:s.questions,sessionCount:((t=s.schedules)==null?void 0:t.length)||1,schedules:(a=s.schedules)!=null&&a.length?s.schedules:[{name:"Term 1",startDate:s.startDate||"",endDate:s.endDate||""}]}),o(!0)},V=async s=>{if(!window.confirm("Unpublish this assessment? Data will be deleted."))return;(await y.deleteAssessmentProgram(s)).success?k():alert("Failed to delete.")},z=s=>{if(s.schedules&&s.schedules.length>0){const t=new Date,a=s.schedules.find(n=>{const g=new Date(n.startDate),x=new Date(n.endDate);return x.setHours(23,59,59),t>=g&&t<=x});if(a)return{label:`ACTIVE: ${a.name}`,color:"text-green-600 bg-green-100",active:!0};const r=s.schedules.find(n=>new Date(n.startDate)>t);return r?{label:`STARTS IN ${Math.ceil((new Date(r.startDate).getTime()-t.getTime())/864e5)} DAYS`,color:"text-yellow-600 bg-yellow-100",active:!1}:{label:"ENDED",color:"text-slate-500 bg-slate-100",active:!1}}return{label:"ACTIVE",color:"text-green-600 bg-green-100",active:!0}},B=s=>{switch(s){case"STAR":return e.jsx("div",{className:"flex gap-0.5",children:[...Array(5)].map((t,a)=>e.jsx(J,{size:14,className:a<3?"fill-yellow-400 text-yellow-400":"text-slate-200"},a))});case"EMOJI":return e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{size:20,className:"text-green-500"}),e.jsx(Q,{size:20,className:"text-slate-300"}),e.jsx(U,{size:20,className:"text-slate-300"})]});case"YESNO":return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"bg-green-500 text-white p-1 rounded-md shadow-sm",children:e.jsx(se,{size:12})}),e.jsx("div",{className:"bg-slate-100 text-slate-400 p-1 rounded-md",children:e.jsx(ee,{size:12})})]});case"MARK":return e.jsx("div",{className:"border border-slate-300 rounded px-2 py-1 text-xs font-bold w-12 text-center text-slate-700 bg-white",children:"45"});default:return null}};return e.jsxs("div",{className:"animate-fade-in-up",children:[q?e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(c,{variant:"secondary",onClick:()=>{o(!1),b(null)},className:"mb-6 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"})," Back to List"]}),e.jsxs(N,{className:"mb-6 border-t-4 border-t-purple-600",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-50 dark:bg-purple-900/20 rounded-full flex items-center justify-center shrink-0",children:e.jsx(D,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white leading-tight",children:h?"Edit Assessment":"New Assessment"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Configure program details"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Program Name"}),e.jsx(p,{placeholder:"e.g. Daily Hygiene Check",value:l.name,onChange:s=>d({...l,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Evaluation Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["STAR","EMOJI","YESNO","MARK"].map(s=>e.jsxs("div",{onClick:()=>d({...l,type:s}),className:`cursor-pointer p-3 rounded-xl border-2 flex flex-col items-center justify-center gap-2 transition-all ${l.type===s?"border-purple-600 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-slate-200 dark:border-slate-700 hover:border-purple-300"}`,children:[B(s),e.jsx("span",{className:"text-[10px] font-bold",children:s})]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Frequency"}),e.jsxs(S,{value:l.frequency,onChange:s=>d({...l,frequency:s.target.value}),children:[e.jsx("option",{value:"DAILY",children:"Daily"}),e.jsx("option",{value:"WEEKLY",children:"Weekly"}),e.jsx("option",{value:"BIWEEKLY",children:"Bi-Weekly"}),e.jsx("option",{value:"MONTHLY",children:"Monthly"}),e.jsx("option",{value:"ONETIME",children:"One Time"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Assignee"}),e.jsxs(S,{value:l.assignee,onChange:s=>d({...l,assignee:s.target.value}),children:[e.jsx("option",{value:"TEACHER",children:"Teacher Only"}),e.jsx("option",{value:"PARENT",children:"Parent Only"}),e.jsx("option",{value:"BOTH",children:"Both"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Target Classes"}),e.jsx("button",{onClick:R,className:"text-[10px] font-bold text-blue-600 hover:underline",children:l.targetClassIds.length===i.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto custom-scrollbar p-2 border border-slate-100 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-800/50",children:i.map(s=>e.jsx("button",{onClick:()=>M(s.id),className:`text-[10px] font-bold px-2 py-1 rounded-md transition-all ${l.targetClassIds.includes(s.id)?"bg-purple-600 text-white shadow-md":"bg-white dark:bg-slate-700 text-slate-500 border border-slate-200 dark:border-slate-600"}`,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Assessment Criteria"}),e.jsxs("div",{className:"space-y-2",children:[l.questions.map((s,t)=>e.jsxs("div",{className:"flex gap-2 items-center bg-slate-50 dark:bg-slate-800/50 p-2 rounded-lg border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"bg-slate-200 dark:bg-slate-700 w-6 h-6 flex items-center justify-center rounded text-xs font-bold text-slate-500 shrink-0",children:t+1}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(p,{className:"h-8 text-sm",placeholder:"Question / Criteria",value:s.text,onChange:a=>f(t,"text",a.target.value)}),l.assignee==="BOTH"&&e.jsxs("select",{className:"text-[10px] bg-slate-100 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded px-1 py-0.5 w-full",value:s.assignee||"TEACHER",onChange:a=>f(t,"assignee",a.target.value),children:[e.jsx("option",{value:"TEACHER",children:"For Teacher"}),e.jsx("option",{value:"PARENT",children:"For Parent"})]})]}),l.type==="MARK"&&e.jsx(p,{type:"number",className:"w-16 text-center h-8 text-sm",placeholder:"Max",value:s.maxVal,onChange:a=>f(t,"maxVal",parseInt(a.target.value))}),e.jsx("button",{onClick:()=>O(t),className:"p-1.5 text-red-400 hover:bg-red-50 rounded",children:e.jsx(E,{className:"w-4 h-4"})})]},t)),e.jsxs("button",{onClick:H,className:"text-xs font-bold text-blue-600 flex items-center gap-1 hover:bg-blue-50 px-3 py-2 rounded",children:[e.jsx(I,{className:"w-3 h-3"})," Add Criteria"]})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-2",children:"Visual Schedule"}),l.schedules.map((s,t)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(p,{type:"date",value:s.startDate,onChange:a=>A(t,"startDate",a.target.value)}),e.jsx("span",{className:"self-center text-slate-400",children:"to"}),e.jsx(p,{type:"date",value:s.endDate,onChange:a=>A(t,"endDate",a.target.value)})]},t))]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-100 dark:border-slate-700 flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",onClick:()=>{o(!1),b(null)},children:"Cancel"}),e.jsx(c,{onClick:L,className:"bg-purple-600 hover:bg-purple-700 w-40",children:h?"Update Program":"Review & Create"})]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-slate-800 dark:text-white",children:"Assessment Programs"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Manage behavioral and skill-based assessments."})]}),e.jsxs(c,{onClick:()=>o(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700",children:[e.jsx(I,{className:"w-4 h-4"})," Create New"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[v.map(s=>{var a,r,n,g;const t=z(s);return e.jsxs(N,{className:"relative group border-l-4 border-l-purple-500 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:`text-[10px] font-black px-2 py-1 rounded uppercase ${t.color}`,children:t.label}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>$(s),className:"p-1.5 text-slate-400 hover:text-blue-500",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(s.id),className:"p-1.5 text-slate-400 hover:text-red-500",children:e.jsx(E,{className:"w-4 h-4"})})]})]}),e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-white mb-1",children:s.name}),e.jsxs("div",{className:"my-3 flex items-center gap-1 bg-slate-50 dark:bg-slate-900 p-1.5 rounded-lg border border-slate-100 dark:border-slate-800 overflow-x-auto no-scrollbar",children:[e.jsx(W,{className:"w-3 h-3 text-slate-400 shrink-0"}),(a=s.schedules)==null?void 0:a.map((x,T)=>{const F=new Date>=new Date(x.startDate)&&new Date<=new Date(x.endDate||"2099-01-01");return e.jsx("div",{className:`flex-shrink-0 text-[9px] font-bold px-2 py-0.5 rounded border ${F?"bg-purple-100 text-purple-700 border-purple-200":"bg-white dark:bg-slate-800 text-slate-500 border-slate-200 dark:border-slate-700"}`,children:x.name||`Session ${T+1}`},T)}),!((r=s.schedules)!=null&&r.length)&&e.jsx("span",{className:"text-[10px] text-slate-400",children:"Continuous"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3"})," ",s.frequency]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"})," ",s.questions.length," Criteria"]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex-1 text-center border-r border-slate-100 dark:border-slate-700",children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Type"}),e.jsx("p",{className:"text-sm font-bold text-purple-600",children:s.type})]}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Target"}),e.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:(((n=s.targetClassIds)==null?void 0:n.length)||0)===i.length?"All Classes":`${(g=s.targetClassIds)==null?void 0:g.length} Classes`})]})]})]},s.id)}),v.length===0&&e.jsxs("div",{className:"col-span-full py-12 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-50 dark:bg-purple-900/20 rounded-full flex items-center justify-center mx-auto mb-4 text-purple-400",children:e.jsx(D,{className:"w-8 h-8"})}),e.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-300",children:"No Assessments Yet"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:'Create programs like "Daily Hygiene", "Reading Log", or "Prayer Tracker".'}),e.jsx(c,{onClick:()=>o(!0),variant:"secondary",children:"Create First Program"})]})]})]}),P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",children:e.jsxs(N,{className:"max-w-md w-full",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:h?"Update Assessment":"Confirm Assessment"}),e.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600 dark:text-slate-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",l.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",l.type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Schedules:"})," ",l.sessionCount," Sessions"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto bg-slate-50 dark:bg-slate-900 p-2 rounded",children:l.schedules.map((s,t)=>e.jsxs("p",{className:"text-xs",children:[s.name||`Session ${t+1}`,": ",s.startDate," to ",s.endDate]},t))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{onClick:Y,disabled:C,className:"flex-1",children:C?"Saving...":"Confirm & Save"}),e.jsx(c,{variant:"secondary",onClick:()=>j(!1),className:"flex-1",children:"Cancel"})]})]})})]})};export{ae as default};
